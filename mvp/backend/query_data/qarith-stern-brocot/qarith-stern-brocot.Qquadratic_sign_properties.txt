
Require Import ZArithRing.
Require Export Qhomographic_sign.
(* Qhomographic_sign:
Require Export positive_fraction_encoding.
Require Import ZArithRing.

Definition outside_interval (a b : Z) := (Z.sgn a + Z.sgn b)%Z.

Definition inside_interval_1 (o1 o2 : Z) :=
  (0 < o1)%Z /\ (0 < o2)%Z \/ (o1 < 0)%Z /\ (o2 < 0)%Z.

Definition inside_interval_2 (o1 o2 : Z) :=
  (0 < o1)%Z /\ (o2 < 0)%Z \/ (o1 < 0)%Z /\ (0 < o2)%Z.

Lemma inside_interval_1_dec_inf :
 forall o1 o2 : Z, {inside_interval_1 o1 o2} + {~ inside_interval_1 o1 o2}.

Lemma inside_interval_2_dec_inf :
 forall o1 o2 : Z, {inside_interval_2 o1 o2} + {~ inside_interval_2 o1 o2}.

Inductive Qhomographic_sg_denom_nonzero : Z -> Z -> Qpositive -> Prop :=
  | Qhomographic_signok0 :
      forall (c d : Z) (p : Qpositive),
      p = One -> (c + d)%Z <> 0%Z -> Qhomographic_sg_denom_nonzero c d p
  | Qhomographic_signok1 :
      forall (c d : Z) (xs : Qpositive),
      Qhomographic_sg_denom_nonzero c (c + d)%Z xs ->
      Qhomographic_sg_denom_nonzero c d (nR xs)
  | Qhomographic_signok2 :
      forall (c d : Z) (xs : Qpositive),
      Qhomographic_sg_denom_nonzero (c + d)%Z d xs ->
      Qhomographic_sg_denom_nonzero c d (dL xs).

Lemma Qhomographic_signok_1 :
 forall c d : Z, Qhomographic_sg_denom_nonzero c d One -> (c + d)%Z <> 0%Z.

Lemma Qhomographic_signok_2 :
 forall (c d : Z) (xs : Qpositive),
 Qhomographic_sg_denom_nonzero c d (nR xs) ->
 Qhomographic_sg_denom_nonzero c (c + d) xs.

Lemma Qhomographic_signok_3 :
 forall (c d : Z) (xs : Qpositive),
 Qhomographic_sg_denom_nonzero c d (dL xs) ->
 Qhomographic_sg_denom_nonzero (c + d) d xs.

Fixpoint Qhomographic_sign (a b c d : Z) (p : Qpositive) {struct p} :
  forall (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
  Z * (Z * (Z * (Z * Z)) * Qpositive).

Functional Scheme Qhomographic_sign_ind :=
  Induction for Qhomographic_sign Sort Prop.

Scheme Qhomographic_sg_denom_nonzero_inv_dep :=
  Induction for Qhomographic_sg_denom_nonzero Sort Prop.

Lemma Qhomographic_sign_equal :
 forall (a b c d : Z) (p : Qpositive)
   (H1 H2 : Qhomographic_sg_denom_nonzero c d p),
 Qhomographic_sign a b c d p H1 = Qhomographic_sign a b c d p H2.

Lemma Qhomographic_sign_equal_strong :
 forall (a1 a2 b1 b2 c1 c2 d1 d2 : Z) (p1 p2 : Qpositive)
   (H_ok_1 : Qhomographic_sg_denom_nonzero c1 d1 p1)
   (H_ok_2 : Qhomographic_sg_denom_nonzero c2 d2 p2),
 a1 = a2 ->
 b1 = b2 ->
 c1 = c2 ->
 d1 = d2 ->
 p1 = p2 ->
 Qhomographic_sign a1 b1 c1 d1 p1 H_ok_1 =
 Qhomographic_sign a2 b2 c2 d2 p2 H_ok_2.

Lemma sg_One_2 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = One ->
 Z.sgn (a + b) = 0%Z ->

Lemma sg_One_3 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = One ->
 Z.sgn (a + b) <> 0%Z ->

Lemma sg_One_4 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = One ->
 Z.sgn (a + b) <> 0%Z ->

Lemma Qhomographic_sign_nR_1 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b = 0%Z ->
 d = 0%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((Z.sgn a * Z.sgn c)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_2 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b = 0%Z ->
 d <> 0%Z ->
 (0 < outside_interval c d)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (Z.sgn a, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_3 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b = 0%Z ->
 d <> 0%Z ->
 ~ (0 < outside_interval c d)%Z ->
 (outside_interval c d < 0)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((- Z.sgn a)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_4 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c 
                                        (c + d) xs)
   (H_Qhomographic_sg_denom_nonzero_nR : Qhomographic_sg_denom_nonzero c d
                                           (nR xs)),
 b = 0%Z ->
 d <> 0%Z ->
 ~ (0 < outside_interval c d)%Z ->
 ~ (outside_interval c d < 0)%Z ->
 Qhomographic_sign a b c d (nR xs) H_Qhomographic_sg_denom_nonzero_nR =
 Qhomographic_sign a (a + b) c (c + d) xs H_Qhomographic_sg_denom_nonzero.

Lemma Qhomographic_sign_nR_5 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b <> 0%Z ->
 d = 0%Z ->
 (0 < outside_interval a b)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (Z.sgn c, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_6 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b <> 0%Z ->
 d = 0%Z ->
 ~ (0 < outside_interval a b)%Z ->
 (outside_interval a b < 0)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((- Z.sgn c)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_7 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c 
                                        (c + d) xs)
   (H_Qhomographic_sg_denom_nonzero_nR : Qhomographic_sg_denom_nonzero c d
                                           (nR xs)),
 b <> 0%Z ->
 d = 0%Z ->
 ~ (0 < outside_interval a b)%Z ->
 ~ (outside_interval a b < 0)%Z ->
 Qhomographic_sign a b c d (nR xs) H_Qhomographic_sg_denom_nonzero_nR =
 Qhomographic_sign a (a + b) c (c + d) xs H_Qhomographic_sg_denom_nonzero.

Lemma Qhomographic_sign_nR_8 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b <> 0%Z ->
 d <> 0%Z ->
 inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (1%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_9 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = nR xs ->
 b <> 0%Z ->
 d <> 0%Z ->
 ~ inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 inside_interval_2 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((-1)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_nR_10 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c 
                                        (c + d) xs)
   (H_Qhomographic_sg_denom_nonzero_nR : Qhomographic_sg_denom_nonzero c d
                                           (nR xs)),
 b <> 0%Z ->
 d <> 0%Z ->
 ~ inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 ~ inside_interval_2 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d (nR xs) H_Qhomographic_sg_denom_nonzero_nR =
 Qhomographic_sign a (a + b) c (c + d) xs H_Qhomographic_sg_denom_nonzero.

Lemma Qhomographic_sign_dL_1 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b = 0%Z ->
 d = 0%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((Z.sgn a * Z.sgn c)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_2 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b = 0%Z ->
 d <> 0%Z ->
 (0 < outside_interval c d)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (Z.sgn a, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_3 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b = 0%Z ->
 d <> 0%Z ->
 ~ (0 < outside_interval c d)%Z ->
 (outside_interval c d < 0)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((- Z.sgn a)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_4 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (c + d) d xs)
   (H_Qhomographic_sg_denom_nonzero_dL : Qhomographic_sg_denom_nonzero c d
                                           (dL xs)),
 b = 0%Z ->
 d <> 0%Z ->
 ~ (0 < outside_interval c d)%Z ->
 ~ (outside_interval c d < 0)%Z ->
 Qhomographic_sign a b c d (dL xs) H_Qhomographic_sg_denom_nonzero_dL =
 Qhomographic_sign (a + b) b (c + d) d xs H_Qhomographic_sg_denom_nonzero.

Lemma Qhomographic_sign_dL_5 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b <> 0%Z ->
 d = 0%Z ->
 (0 < outside_interval a b)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (Z.sgn c, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_6 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b <> 0%Z ->
 d = 0%Z ->
 ~ (0 < outside_interval a b)%Z ->
 (outside_interval a b < 0)%Z ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((- Z.sgn c)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_7 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (c + d) d xs)
   (H_Qhomographic_sg_denom_nonzero_dL : Qhomographic_sg_denom_nonzero c d
                                           (dL xs)),
 b <> 0%Z ->
 d = 0%Z ->
 ~ (0 < outside_interval a b)%Z ->
 ~ (outside_interval a b < 0)%Z ->
 Qhomographic_sign a b c d (dL xs) H_Qhomographic_sg_denom_nonzero_dL =
 Qhomographic_sign (a + b) b (c + d) d xs H_Qhomographic_sg_denom_nonzero.

Lemma Qhomographic_sign_dL_8 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b <> 0%Z ->
 d <> 0%Z ->
 inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (1%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_9 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 p = dL xs ->
 b <> 0%Z ->
 d <> 0%Z ->
 ~ inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 inside_interval_2 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((-1)%Z, (a, (b, (c, d)), p)).

Lemma Qhomographic_sign_dL_10 :
 forall (a b c d : Z) (p xs : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (c + d) d xs)
   (H_Qhomographic_sg_denom_nonzero_dL : Qhomographic_sg_denom_nonzero c d
                                           (dL xs)),
 b <> 0%Z ->
 d <> 0%Z ->
 ~ inside_interval_1 (outside_interval a b) (outside_interval c d) ->
 ~ inside_interval_2 (outside_interval a b) (outside_interval c d) ->
 Qhomographic_sign a b c d (dL xs) H_Qhomographic_sg_denom_nonzero_dL =
 Qhomographic_sign (a + b) b (c + d) d xs H_Qhomographic_sg_denom_nonzero.

Lemma sg_sign :
 forall (a b c d : Z) (qp : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d qp),
 let (l1, L2) :=
     Qhomographic_sign a b c d qp H_Qhomographic_sg_denom_nonzero in
 {l1 = 0%Z} + {l1 = 1%Z} + {l1 = (-1)%Z}.

Definition h_sign (a b c d : Z) (p : Qpositive)
  (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p) :=
  let (l1, L2) :=
      Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero in
  l1.

Lemma sg_sign_dec :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 {h_sign a b c d p H_Qhomographic_sg_denom_nonzero = 0%Z} +
 {h_sign a b c d p H_Qhomographic_sg_denom_nonzero = 1%Z} +
 {h_sign a b c d p H_Qhomographic_sg_denom_nonzero = (-1)%Z}. *)
Require Export Qquadratic_sign.
(* Qquadratic_sign:
Require Import ZArithRing.
Require Import Qhomographic_sign.
Require Import Zaux.

Definition outside_square (a b c d : Z) :=
  (Z.sgn a + Z.sgn b + Z.sgn c + Z.sgn d)%Z.

Lemma three_integers_dec_inf :
 forall a b c : Z,
 {a = 0%Z /\ b = 0%Z /\ c = 0%Z} + {~ (a = 0%Z /\ b = 0%Z /\ c = 0%Z)}.

Definition inside_square_1 (o1 o2 : Z) :=
  (2 < o1)%Z /\ (2 < o2)%Z \/ (o1 < -2)%Z /\ (o2 < -2)%Z.

Definition inside_square_2 (o1 o2 : Z) :=
  (2 < o1)%Z /\ (o2 < -2)%Z \/ (o1 < -2)%Z /\ (2 < o2)%Z.

Lemma inside_square_1_dec_inf :
 forall o1 o2 : Z, {inside_square_1 o1 o2} + {~ inside_square_1 o1 o2}.

Lemma inside_square_2_dec_inf :
 forall o1 o2 : Z, {inside_square_2 o1 o2} + {~ inside_square_2 o1 o2}.

Inductive Qquadratic_sg_denom_nonzero :
Z -> Z -> Z -> Z -> Qpositive -> Qpositive -> Prop :=
  | Qquadratic_signok0 :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      p2 = One ->
      Qhomographic_sg_denom_nonzero (e + f) (g + h) p1 ->
      Qquadratic_sg_denom_nonzero e f g h p1 p2
  | Qquadratic_signok0' :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      p1 = One ->
      Qhomographic_sg_denom_nonzero (e + g) (f + h) p2 ->
      Qquadratic_sg_denom_nonzero e f g h p1 p2
  | Qquadratic_signok1 :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      Qquadratic_sg_denom_nonzero e (e + f)%Z (e + g)%Z 
        (e + f + g + h)%Z p1 p2 ->
      Qquadratic_sg_denom_nonzero e f g h (nR p1) (nR p2)
  | Qquadratic_signok2 :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      Qquadratic_sg_denom_nonzero (e + f)%Z f (e + f + g + h)%Z 
        (f + h)%Z p1 p2 ->
      Qquadratic_sg_denom_nonzero e f g h (nR p1) (dL p2)
  | Qquadratic_signok3 :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      Qquadratic_sg_denom_nonzero (e + g)%Z (e + f + g + h)%Z g 
        (g + h)%Z p1 p2 ->
      Qquadratic_sg_denom_nonzero e f g h (dL p1) (nR p2)
  | Qquadratic_signok4 :
      forall (e f g h : Z) (p1 p2 : Qpositive),
      Qquadratic_sg_denom_nonzero (e + f + g + h)%Z 
        (f + h)%Z (g + h)%Z h p1 p2 ->
      Qquadratic_sg_denom_nonzero e f g h (dL p1) (dL p2).

Lemma Qquadratic_signok_0 :
 forall (e f g h : Z) (p2 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h One p2 ->
 Qhomographic_sg_denom_nonzero (e + g) (f + h) p2.

Lemma Qquadratic_signok_0' :
 forall (e f g h : Z) (p1 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h p1 One ->
 Qhomographic_sg_denom_nonzero (e + f) (g + h) p1.

Lemma Qquadratic_signok_1 :
 forall (e f g h : Z) (p1 p2 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h (nR p1) (nR p2) ->
 Qquadratic_sg_denom_nonzero e (e + f) (e + g) (e + f + g + h) p1 p2.

Lemma Qquadratic_signok_2 :
 forall (e f g h : Z) (p1 p2 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h (nR p1) (dL p2) ->
 Qquadratic_sg_denom_nonzero (e + f) f (e + f + g + h) (f + h) p1 p2.

Lemma Qquadratic_signok_3 :
 forall (e f g h : Z) (p1 p2 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h (dL p1) (nR p2) ->
 Qquadratic_sg_denom_nonzero (e + g) (e + f + g + h) g (g + h) p1 p2.

Lemma Qquadratic_signok_4 :
 forall (e f g h : Z) (p1 p2 : Qpositive),
 Qquadratic_sg_denom_nonzero e f g h (dL p1) (dL p2) ->
 Qquadratic_sg_denom_nonzero (e + f + g + h) (f + h) (g + h) h p1 p2.

Fixpoint Qquadratic_sign (a b c d e f g h : Z) (p1 p2 : Qpositive) {struct p1} :
  forall (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
  Z * (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) * (Qpositive * Qpositive)).

Scheme Qquadratic_sg_denom_nonzero_inv_dep :=
  Induction for Qquadratic_sg_denom_nonzero Sort Prop.

Lemma Qquadratic_sign_equal :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H1 H2 : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 Qquadratic_sign a b c d e f g h p1 p2 H1 =
 Qquadratic_sign a b c d e f g h p1 p2 H2.

Lemma Qquadratic_sign_equal_strong :
 forall (a1 a2 b1 b2 c1 c2 d1 d2 e1 e2 f1 f2 g1 g2 h1 h2 : Z)
   (x1 x2 y1 y2 : Qpositive)
   (H_ok_1 : Qquadratic_sg_denom_nonzero e1 f1 g1 h1 x1 y1)
   (H_ok_2 : Qquadratic_sg_denom_nonzero e2 f2 g2 h2 x2 y2),
 a1 = a2 ->
 b1 = b2 ->
 c1 = c2 ->
 d1 = d2 ->
 e1 = e2 ->
 f1 = f2 ->
 g1 = g2 ->
 h1 = h2 ->
 x1 = x2 ->
 y1 = y2 ->
 Qquadratic_sign a1 b1 c1 d1 e1 f1 g1 h1 x1 y1 H_ok_1 =
 Qquadratic_sign a2 b2 c2 d2 e2 f2 g2 h2 x2 y2 H_ok_2.

Lemma Qquadratic_sign_One_y :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (l1 na nb nc nd : Z) (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + g) (f + h) p2),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
   H_Qhomographic_sg_denom_nonzero ->
 p1 = One ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (0%Z, (na, nb)), (0%Z, (0%Z, (nc, nd))), (One, l3))).

Lemma Qquadratic_sign_nRdL_One :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (l1 na nb nc nd : Z) (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + f) (g + h) p1),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + b) (c + d) (e + f) (g + h) p1
   H_Qhomographic_sg_denom_nonzero ->
 p1 <> One ->
 p2 = One ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (na, (0%Z, nb)), (0%Z, (nc, (0%Z, nd))), (l3, One))).

Lemma Qquadratic_sign_nR_One_1 :
 forall (a b c d e f g h : Z) (p1 xs p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (l1 na nb nc nd : Z) (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + f) (g + h) p1),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + b) (c + d) (e + f) (g + h) p1
   H_Qhomographic_sg_denom_nonzero ->
 p1 = nR xs ->
 p2 = One ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (na, (0%Z, nb)), (0%Z, (nc, (0%Z, nd))), (l3, One))).

Lemma Qquadratic_sign_nR_One_2 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h
                                      (nR p1) p2) (l1 na nb nc nd : Z)
   (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + f) (g + h) 
                                        (nR p1)),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
   (nR p1) H_Qhomographic_sg_denom_nonzero ->
 p2 = One ->
 Qquadratic_sign a b c d e f g h (nR p1) p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (na, (0%Z, nb)), (0%Z, (nc, (0%Z, nd))), (l3, One))).

Lemma Qquadratic_sign_dL_One_1 :
 forall (a b c d e f g h : Z) (p1 xs p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (l1 na nb nc nd : Z) (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + f) (g + h) p1),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + b) (c + d) (e + f) (g + h) p1
   H_Qhomographic_sg_denom_nonzero ->
 p1 = dL xs ->
 p2 = One ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (na, (0%Z, nb)), (0%Z, (nc, (0%Z, nd))), (l3, One))).

Lemma Qquadratic_sign_dL_One_2 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h
                                      (dL p1) p2) (l1 na nb nc nd : Z)
   (l3 : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero 
                                        (e + f) (g + h) 
                                        (dL p1)),
 (l1, (na, (nb, (nc, nd)), l3)) =
 Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
   (dL p1) H_Qhomographic_sg_denom_nonzero ->
 p2 = One ->
 Qquadratic_sign a b c d e f g h (dL p1) p2 H_Qquadratic_sg_denom_nonzero =
 (l1, (0%Z, (na, (0%Z, nb)), (0%Z, (nc, (0%Z, nd))), (l3, One))).

Lemma Qquadratic_sign_nRdL_nRdL_1 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((Z.sgn a * Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).

Lemma Qquadratic_sign_nRdL_nRdL_2 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 (2 < outside_square e f g h)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).             

Lemma Qquadratic_sign_nRdL_nRdL_3 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ (2 < outside_square e f g h)%Z ->
 (outside_square e f g h < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).             

Lemma Qquadratic_sign_nR_nR_4 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_II : Qquadratic_sg_denom_nonzero e 
                                         (e + f) (e + g) 
                                         (e + f + g + h) xs ys),
 p1 = nR xs ->
 p2 = nR ys ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ (2 < outside_square e f g h)%Z ->
 ~ (outside_square e f g h < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
   (e + f) (e + g) (e + f + g + h) xs ys H_Qquadratic_sg_denom_nonzero_II.

Lemma Qquadratic_sign_nR_dL_4 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_IO : Qquadratic_sg_denom_nonzero 
                                         (e + f) f 
                                         (e + f + g + h) 
                                         (f + h) xs ys),
 p1 = nR xs ->
 p2 = dL ys ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ (2 < outside_square e f g h)%Z ->
 ~ (outside_square e f g h < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
   (e + f) f (e + f + g + h) (f + h) xs ys H_Qquadratic_sg_denom_nonzero_IO.

Lemma Qquadratic_sign_dL_nR_4 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OI : Qquadratic_sg_denom_nonzero 
                                         (e + g) (e + f + g + h) g 
                                         (g + h) xs ys),
 p1 = dL xs ->
 p2 = nR ys ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ (2 < outside_square e f g h)%Z ->
 ~ (outside_square e f g h < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
   (e + g) (e + f + g + h) g (g + h) xs ys H_Qquadratic_sg_denom_nonzero_OI.

Lemma Qquadratic_sign_dL_dL_4 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OO : Qquadratic_sg_denom_nonzero
                                         (e + f + g + h) 
                                         (f + h) (g + h) h xs ys),
 p1 = dL xs ->
 p2 = dL ys ->
 b = 0%Z /\ c = 0%Z /\ d = 0%Z ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ (2 < outside_square e f g h)%Z ->
 ~ (outside_square e f g h < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
   (e + f + g + h) (f + h) (g + h) h xs ys H_Qquadratic_sg_denom_nonzero_OO.

Lemma Qquadratic_sign_nRdL_nRdL_5 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 (2 < outside_square a b c d)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).

Lemma Qquadratic_sign_nRdL_nRdL_6 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 ~ (2 < outside_square a b c d)%Z ->
 (outside_square a b c d < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).

Lemma Qquadratic_sign_nR_nR_7 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_II : Qquadratic_sg_denom_nonzero e 
                                         (e + f) (e + g) 
                                         (e + f + g + h) xs ys),
 p1 = nR xs ->
 p2 = nR ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 ~ (2 < outside_square a b c d)%Z ->
 ~ (outside_square a b c d < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
   (e + f) (e + g) (e + f + g + h) xs ys H_Qquadratic_sg_denom_nonzero_II.

Lemma Qquadratic_sign_nR_dL_7 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_IO : Qquadratic_sg_denom_nonzero 
                                         (e + f) f 
                                         (e + f + g + h) 
                                         (f + h) xs ys),
 p1 = nR xs ->
 p2 = dL ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 ~ (2 < outside_square a b c d)%Z ->
 ~ (outside_square a b c d < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
   (e + f) f (e + f + g + h) (f + h) xs ys H_Qquadratic_sg_denom_nonzero_IO.

Lemma Qquadratic_sign_dL_nR_7 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OI : Qquadratic_sg_denom_nonzero 
                                         (e + g) (e + f + g + h) g 
                                         (g + h) xs ys),
 p1 = dL xs ->
 p2 = nR ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 ~ (2 < outside_square a b c d)%Z ->
 ~ (outside_square a b c d < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
   (e + g) (e + f + g + h) g (g + h) xs ys H_Qquadratic_sg_denom_nonzero_OI.

Lemma Qquadratic_sign_dL_dL_7 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OO : Qquadratic_sg_denom_nonzero
                                         (e + f + g + h) 
                                         (f + h) (g + h) h xs ys),
 p1 = dL xs ->
 p2 = dL ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 f = 0%Z /\ g = 0%Z /\ h = 0%Z ->
 ~ (2 < outside_square a b c d)%Z ->
 ~ (outside_square a b c d < -2)%Z ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
   (e + f + g + h) (f + h) (g + h) h xs ys H_Qquadratic_sg_denom_nonzero_OO.

Lemma Qquadratic_sign_nRdL_nRdL_8 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).

Lemma Qquadratic_sign_nRdL_nRdL_9 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 p1 <> One ->
 p2 <> One ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 inside_square_2 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (p1, p2))).

Lemma Qquadratic_sign_nR_nR_10 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_II : Qquadratic_sg_denom_nonzero e 
                                         (e + f) (e + g) 
                                         (e + f + g + h) xs ys),
 p1 = nR xs ->
 p2 = nR ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 ~ inside_square_2 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
   (e + f) (e + g) (e + f + g + h) xs ys H_Qquadratic_sg_denom_nonzero_II.

Lemma Qquadratic_sign_nR_dL_10 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_IO : Qquadratic_sg_denom_nonzero 
                                         (e + f) f 
                                         (e + f + g + h) 
                                         (f + h) xs ys),
 p1 = nR xs ->
 p2 = dL ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 ~ inside_square_2 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
   (e + f) f (e + f + g + h) (f + h) xs ys H_Qquadratic_sg_denom_nonzero_IO.

Lemma Qquadratic_sign_dL_nR_10 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OI : Qquadratic_sg_denom_nonzero 
                                         (e + g) (e + f + g + h) g 
                                         (g + h) xs ys),
 p1 = dL xs ->
 p2 = nR ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 ~ inside_square_2 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
   (e + g) (e + f + g + h) g (g + h) xs ys H_Qquadratic_sg_denom_nonzero_OI.

Lemma Qquadratic_sign_dL_dL_10 :
 forall (a b c d e f g h : Z) (p1 xs p2 ys : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (H_Qquadratic_sg_denom_nonzero_OO : Qquadratic_sg_denom_nonzero
                                         (e + f + g + h) 
                                         (f + h) (g + h) h xs ys),
 p1 = dL xs ->
 p2 = dL ys ->
 ~ (b = 0%Z /\ c = 0%Z /\ d = 0%Z) ->
 ~ (f = 0%Z /\ g = 0%Z /\ h = 0%Z) ->
 ~ inside_square_1 (outside_square a b c d) (outside_square e f g h) ->
 ~ inside_square_2 (outside_square a b c d) (outside_square e f g h) ->
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
   (e + f + g + h) (f + h) (g + h) h xs ys H_Qquadratic_sg_denom_nonzero_OO.

Lemma Qquadratic_sign_sign :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 let (l1, L2) :=
     Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero in
 {l1 = 0%Z} + {l1 = 1%Z} + {l1 = (-1)%Z}.

Definition q_sign (a b c d e f g h : Z) (p1 p2 : Qpositive)
  (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2) :=
  let (l1, L2) :=
      Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero in
  l1.

Lemma Qquadratic_sign_sign_dec :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),
 {q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = 0%Z} +
 {q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = 1%Z} +
 {q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = (-1)%Z}. *)
Require Export Qhomographic_sign_properties.
(* Qhomographic_sign_properties:
Require Export Qhomographic_sign.
Require Import ZArithRing Zaux.

Lemma sg_tuple_equal :
 forall (l1 a1 b1 c1 d1 : Z) (p1 : Qpositive) (l2 a2 b2 c2 d2 : Z)
   (p2 : Qpositive),
 (l1, (a1, (b1, (c1, d1)), p1)) = (l2, (a2, (b2, (c2, d2)), p2)) ->
 l1 = l2 /\ (a1 = a2 /\ b1 = b2 /\ c1 = c2 /\ d1 = d2) /\ p1 = p2.

Lemma inside_interval_1_inf :
 forall o1 o2 : Z,
 inside_interval_1 o1 o2 ->
 {(0 < o1)%Z /\ (0 < o2)%Z} + {(o1 < 0)%Z /\ (o2 < 0)%Z}.
   
Lemma inside_interval_2_inf :
 forall o1 o2 : Z,
 inside_interval_2 o1 o2 ->
 {(0 < o1)%Z /\ (o2 < 0)%Z} + {(o1 < 0)%Z /\ (0 < o2)%Z}.
   
Lemma sg_pos_1 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p)
   (na nb nc nd : Z) (np : Qpositive),
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (1%Z, (na, (nb, (nc, nd)), np)) ->
 {(0 < na + nb)%Z /\ (0 < nc + nd)%Z} + {(na + nb < 0)%Z /\ (nc + nd < 0)%Z}.

Lemma sg_pos_2 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p)
   (na nb nc nd : Z) (np : Qpositive),
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 (1%Z, (na, (nb, (nc, nd)), np)) ->
 {(0 <= na)%Z /\ (0 <= nb)%Z /\ (0 <= nc)%Z /\ (0 <= nd)%Z} +
 {(na <= 0)%Z /\ (nb <= 0)%Z /\ (nc <= 0)%Z /\ (nd <= 0)%Z} + 
 {np = One}.

Lemma sg_neg_1 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p)
   (na nb nc nd : Z) (np : Qpositive),
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((-1)%Z, (na, (nb, (nc, nd)), np)) ->
 {(0 < na + nb)%Z /\ (nc + nd < 0)%Z} + {(na + nb < 0)%Z /\ (0 < nc + nd)%Z}.

Lemma sg_neg_2 :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p)
   (na nb nc nd : Z) (np : Qpositive),
 Qhomographic_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 ((-1)%Z, (na, (nb, (nc, nd)), np)) ->
 {(0 <= na)%Z /\ (0 <= nb)%Z /\ (nc <= 0)%Z /\ (nd <= 0)%Z} +
 {(na <= 0)%Z /\ (nb <= 0)%Z /\ (0 <= nc)%Z /\ (0 <= nd)%Z} + 
 {np = One}. *)

Definition same_ratio (a b c d e f g h : Z) :=
  (a * f)%Z = (b * e)%Z /\
  (b * g)%Z = (c * f)%Z /\
  (c * h)%Z = (d * g)%Z /\
  (a * g)%Z = (c * e)%Z /\ (a * h)%Z = (d * e)%Z /\ (b * h)%Z = (d * f)%Z.

Lemma same_ratio_dec_inf :
 forall a b c d e f g h : Z,
 {same_ratio a b c d e f g h} + {~ same_ratio a b c d e f g h}.
Proof. 
 intros.
 case (Z.eq_dec (a * f) (b * e));
  [ case (Z.eq_dec (b * g) (c * f));
     [ case (Z.eq_dec (c * h) (d * g));
        [ case (Z.eq_dec (a * g) (c * e));
           [ case (Z.eq_dec (a * h) (d * e));
              [ case (Z.eq_dec (b * h) (d * f));
                 [ left; repeat split; assumption | idtac ]
              | idtac ]
           | idtac ]
        | idtac ]
     | idtac ]
  | idtac ]; intro H'; try intros; right;
  intros (Hafbe, (Hbgcf, (Hchgd, (Hagce, (Hahde, Hbhdf))))); 
  apply H'; assumption.
Qed.

Lemma Qquadratic_sign_tuple_equal :
 forall (l1 a1 b1 c1 d1 e1 f1 g1 h1 : Z) (x1 y1 : Qpositive)
   (l2 a2 b2 c2 d2 e2 f2 g2 h2 : Z) (x2 y2 : Qpositive),
 (l1, (a1, (b1, (c1, d1)), (e1, (f1, (g1, h1))), (x1, y1))) =
 (l2, (a2, (b2, (c2, d2)), (e2, (f2, (g2, h2))), (x2, y2))) ->
 l1 = l2 /\
 (a1 = a2 /\
  b1 = b2 /\ c1 = c2 /\ d1 = d2 /\ e1 = e2 /\ f1 = f2 /\ g1 = g2 /\ h1 = h2) /\
 x1 = x2 /\ y1 = y2.
Proof.
 intros.
 inversion H; (repeat split; reflexivity).
Qed.

Lemma outside_square_1 :
 forall a b c d : Z, (2 < outside_square a b c d)%Z -> (0 < a + b + c + d)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first [ discriminate H | repeat constructor ].
Qed.

Lemma outside_square_2 :
 forall a b c d : Z, (outside_square a b c d < -2)%Z -> (a + b + c + d < 0)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first [ discriminate H | repeat constructor ].
Qed.

Lemma outside_square_3 :
 forall a b c d : Z, (2 < outside_square a b c d)%Z -> (0 <= a)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_4 :
 forall a b c d : Z, (2 < outside_square a b c d)%Z -> (0 <= b)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_5 :
 forall a b c d : Z, (2 < outside_square a b c d)%Z -> (0 <= c)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_6 :
 forall a b c d : Z, (2 < outside_square a b c d)%Z -> (0 <= d)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_7 :
 forall a b c d : Z, (outside_square a b c d < -2)%Z -> (a <= 0)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_8 :
 forall a b c d : Z, (outside_square a b c d < -2)%Z -> (b <= 0)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_9 :
 forall a b c d : Z, (outside_square a b c d < -2)%Z -> (c <= 0)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma outside_square_10 :
 forall a b c d : Z, (outside_square a b c d < -2)%Z -> (d <= 0)%Z.
Proof.
intros [| pa| pa] [| pb| pb] [| pc| pc] [| pd| pd];
            repeat rewrite Zplus_0_r; repeat rewrite Zplus_0_l; 
            intro H; first
            [ intro H_discriminate_me; discriminate H_discriminate_me
            | discriminate H
            | repeat constructor
            | apply Zero_le_Qpos ].
Qed.

Lemma inside_square_1_inf :
 forall o1 o2 : Z,
 inside_square_1 o1 o2 ->
 {(2 < o1)%Z /\ (2 < o2)%Z} + {(o1 < -2)%Z /\ (o2 < -2)%Z}.
Proof.
 intros o1 o2 H.
 case (Z_lt_dec 2 o1); intros Ho1;
            [ case (Z_lt_dec 2 o2); intros Ho2;
               [ left; split; assumption | idtac ]
            | case (Z_lt_dec o1 (-2)); intros Ho1';
               [ case (Z_lt_dec o2 (-2)); intros Ho2;
                  [ right; split; assumption | idtac ]
               | idtac ] ]; apply False_rec; case H; 
            intros (Ho1_, Ho2_);
            repeat
             match goal with
             | id1:(~ (?X1 < ?X2)%Z) |- ?X3 => apply id1; assumption
             end ||
               match goal with
               | id1:(Zpos ?X1 < ?X2)%Z,id2:(?X2 < Zneg ?X1)%Z |- ?X3 =>
                   apply (Z.lt_irrefl (Zpos X1));
                    apply Z.lt_trans with (Zneg X1);
                    constructor || apply Z.lt_trans with X2; 
                    assumption
               end.
Qed.

Lemma inside_square_2_inf :
 forall o1 o2 : Z,
 inside_square_2 o1 o2 ->
 {(2 < o1)%Z /\ (o2 < -2)%Z} + {(o1 < -2)%Z /\ (2 < o2)%Z}.
Proof.
 intros o1 o2 H.
 case (Z_lt_dec 2 o1); intros Ho1;
            [ case (Z_lt_dec o2 (-2)); intros Ho2;
               [ left; split; assumption | idtac ]
            | case (Z_lt_dec o1 (-2)); intros Ho1';
               [ case (Z_lt_dec 2 o2); intros Ho2;
                  [ right; split; assumption | idtac ]
               | idtac ] ]; apply False_rec; case H; 
            intros (Ho1_, Ho2_);
            repeat
             match goal with
             | id1:(~ (?X1 < ?X2)%Z) |- ?X3 => apply id1; assumption
             end ||
               match goal with
               | id1:(Zpos ?X1 < ?X2)%Z,id2:(?X2 < Zneg ?X1)%Z |- ?X3 =>
                   apply (Z.lt_irrefl (Zpos X1));
                    apply Z.lt_trans with (Zneg X1);
                    constructor || apply Z.lt_trans with X2; 
                    assumption
               end.
Qed.

Lemma Qquadratic_sign_pos_1 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (na nb nc nd ne nf ng nh : Z) (np1 np2 : Qpositive),
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) ->
 {(0 < na + nb + nc + nd)%Z /\ (0 < ne + nf + ng + nh)%Z} +
 {(na + nb + nc + nd < 0)%Z /\ (ne + nf + ng + nh < 0)%Z}.
Proof. 
 fix Qquadratic_sign_pos_1 9.
 intros.
 set (o1 := outside_square a b c d) in *.
 set (o2 := outside_square e f g h) in *.
 destruct p1 as [xs| xs| ].
 
 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1, hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1, hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_9; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
             (hp1, hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_10; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_4 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1, hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_9; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
             (hp1, hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_10; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_7 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1, hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     case (inside_square_1_inf _ _ H_inside_1); intros (Ho1, Ho2);
      [ left; split; apply outside_square_1
      | right; split; apply outside_square_2 ]; assumption.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
             (hp1, hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_nR_10 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_9; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_10; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_4 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_9; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_10; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_7 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     case (inside_square_1_inf _ _ H_inside_1); intros (Ho1, Ho2);
      [ left; split; apply outside_square_1
      | right; split; apply outside_square_2 ]; assumption.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_dL_10 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (nR xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (nR xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite Zplus_0_l; repeat rewrite Zplus_0_r ];
   apply
    (sg_pos_1 (a + b) (c + d) (e + f) (g + h) (nR xs)
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.

 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_9; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_10; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_4 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_9; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_10; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_7 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     case (inside_square_1_inf _ _ H_inside_1); intros (Ho1, Ho2);
      [ left; split; apply outside_square_1
      | right; split; apply outside_square_2 ]; assumption.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_nR_10 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_9; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_10; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_4 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_9; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_10; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_7 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     case (inside_square_1_inf _ _ H_inside_1); intros (Ho1, Ho2);
      [ left; split; apply outside_square_1
      | right; split; apply outside_square_2 ]; assumption.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_dL_10 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (dL xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (dL xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite Zplus_0_l; repeat rewrite Zplus_0_r ];
   apply
    (sg_pos_1 (a + b) (c + d) (e + f) (g + h) (dL xs)
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.

  generalize (Qquadratic_signok_0 _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_One_y a b c d e f g h One p2
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (0%Z, (na_, nb_)), (0%Z, (0%Z, (nc_, nd_))), (One, l3))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h One p2
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite Zplus_0_l; repeat rewrite Zplus_0_r ];
   apply
    (sg_pos_1 (a + c) (b + d) (e + g) (f + h) p2
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
Qed.

Lemma Qquadratic_sign_pos_2 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (na nb nc nd ne nf ng nh : Z) (np1 np2 : Qpositive),
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) ->
 {(0 <= na)%Z /\
  (0 <= nb)%Z /\
  (0 <= nc)%Z /\
  (0 <= nd)%Z /\ (0 <= ne)%Z /\ (0 <= nf)%Z /\ (0 <= ng)%Z /\ (0 <= nh)%Z} +
 {(na <= 0)%Z /\
  (nb <= 0)%Z /\
  (nc <= 0)%Z /\
  (nd <= 0)%Z /\ (ne <= 0)%Z /\ (nf <= 0)%Z /\ (ng <= 0)%Z /\ (nh <= 0)%Z} +
 {np1 = One /\
  (0 <= na + nc)%Z /\
  (0 <= nb + nd)%Z /\ (0 <= ne + ng)%Z /\ (0 <= nf + nh)%Z} +
 {np1 = One /\
  (na + nc <= 0)%Z /\
  (nb + nd <= 0)%Z /\ (ne + ng <= 0)%Z /\ (nf + nh <= 0)%Z} +
 {np1 = One /\ np2 = One} +
 {np1 <> One /\
  np2 = One /\
  (0 <= na + nb)%Z /\
  (0 <= nc + nd)%Z /\ (0 <= ne + nf)%Z /\ (0 <= ng + nh)%Z} +
 {np1 <> One /\
  np2 = One /\
  (na + nb <= 0)%Z /\
  (nc + nd <= 0)%Z /\ (ne + nf <= 0)%Z /\ (ng + nh <= 0)%Z}.
Proof.
 fix Qquadratic_sign_pos_2 9.
 intros.
 set (o1 := outside_square a b c d) in *.
 set (o2 := outside_square e f g h) in *.
 destruct p1 as [xs| xs| ].
 
 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_4 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_7 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; case (inside_square_1_inf _ _ H_inside_1);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
          
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_nR_10 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_4 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_7 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; case (inside_square_1_inf _ _ H_inside_1);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
          
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_dL_10 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
 
  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (nR xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (nR xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite ZERO_right ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero =
    (1%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_pos_2 (a + b) (c + d) (e + f) (g + h) (nR xs)
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3];
   [ case l3; left;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; right; repeat split ]
   | case l3;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; left; right; repeat split ]
   | left; left; right; repeat split; assumption ].

 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_4 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_7 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; case (inside_square_1_inf _ _ H_inside_1);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
          
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_nR_10 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_16 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_4 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
         |  |- (?X1 <= 0)%Z =>
             apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_7 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; case (inside_square_1_inf _ _ H_inside_1);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z => apply Zlt_le_weak; apply Zsgn_9
        |  |- (?X1 <= 0)%Z =>
            apply Zlt_le_weak; apply Zsgn_10; apply Z.opp_inj
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
          
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      apply False_rec.
      assert
       (H_tuple_eq :
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      discriminate hl.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_dL_10 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_pos_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
 
  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (dL xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (dL xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite ZERO_right ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero =
    (1%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_pos_2 (a + b) (c + d) (e + f) (g + h) (dL xs)
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3];
   [ case l3; left;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; right; repeat split ]
   | case l3;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; left; right; repeat split ]
   | left; left; right; repeat split; assumption ].

  generalize (Qquadratic_signok_0 _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_One_y a b c d e f g h One p2
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    (1%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (0%Z, (na_, nb_)), (0%Z, (0%Z, (nc_, nd_))), (One, l3))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h One p2
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite ZERO_right ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero = (1%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_pos_2 (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3]; left;
   left; [ left; left; right | left; right | right ]; 
   repeat split; assumption.
Qed.

Lemma Qquadratic_sign_neg_1 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (na nb nc nd ne nf ng nh : Z) (np1 np2 : Qpositive),
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) ->
 {(0 < na + nb + nc + nd)%Z /\ (ne + nf + ng + nh < 0)%Z} +
 {(na + nb + nc + nd < 0 < ne + nf + ng + nh)%Z}.
Proof.
 fix Qquadratic_sign_neg_1 9.
 intros.
 set (o1 := outside_square a b c d) in *.
 set (o2 := outside_square e f g h) in *.
 destruct p1 as [xs| xs| ].
 
 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     right; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_10; apply sym_eq | apply outside_square_1 ]; 
      assumption.
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_9; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_4 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_10; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_9; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_7 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     case (inside_square_2_inf _ _ H_inside_2); intros (Ho1, Ho2);
      [ left; split; [ apply outside_square_1 | apply outside_square_2 ]
      | right; split; [ apply outside_square_2 | apply outside_square_1 ] ];
      assumption.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_nR_10 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     right; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_10; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_9; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_4 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_10; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_9; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_7 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      case (inside_square_2_inf _ _ H_inside_2); intros (Ho1, Ho2);
       [ left; split; [ apply outside_square_1 | apply outside_square_2 ]
       | right; split; [ apply outside_square_2 | apply outside_square_1 ] ];
       assumption.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_dL_10 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (nR xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (nR xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ];
   apply
    (sg_neg_1 (a + b) (c + d) (e + f) (g + h) (nR xs)
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.

 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     right; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_10; apply sym_eq | apply outside_square_1 ]; 
      assumption.
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_9; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_4 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_10; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_9; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_7 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     case (inside_square_2_inf _ _ H_inside_2); intros (Ho1, Ho2);
      [ left; split; [ apply outside_square_1 | apply outside_square_2 ]
      | right; split; [ apply outside_square_2 | apply outside_square_1 ] ];
      assumption.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_nR_10 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; repeat rewrite Zplus_0_r; assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     right; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply Zsgn_10; apply sym_eq; assumption
      | apply outside_square_1; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply Zsgn_9; apply sym_eq; apply Z.opp_inj; assumption
       | apply outside_square_2; assumption ]. 
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_4 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; repeat rewrite Zplus_0_r;
      [ apply outside_square_1 | apply Zsgn_10; apply sym_eq ]; 
      assumption.
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      right; split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; repeat rewrite Zplus_0_r;
       [ apply outside_square_2
       | apply Zsgn_9; apply sym_eq; apply Z.opp_inj ]; 
       assumption.
      
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_7 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      case (inside_square_2_inf _ _ H_inside_2); intros (Ho1, Ho2);
       [ left; split; [ apply outside_square_1 | apply outside_square_2 ]
       | right; split; [ apply outside_square_2 | apply outside_square_1 ] ];
       assumption.
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_dL_10 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_1 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (dL xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (dL xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ];
   apply
    (sg_neg_1 (a + b) (c + d) (e + f) (g + h) (dL xs)
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.

  generalize (Qquadratic_signok_0 _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_One_y a b c d e f g h One p2
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (0%Z, (na_, nb_)), (0%Z, (0%Z, (nc_, nd_))), (One, l3))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h One p2
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ];
   apply
    (sg_neg_1 (a + c) (b + d) (e + g) (f + h) p2
       H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3); 
   rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
Qed.

Lemma Qquadratic_sign_neg_2 :
 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)
   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)
   (na nb nc nd ne nf ng nh : Z) (np1 np2 : Qpositive),
 Qquadratic_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero =
 ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) ->
 {(0 <= na)%Z /\
  (0 <= nb)%Z /\
  (0 <= nc)%Z /\
  (0 <= nd)%Z /\ (ne <= 0)%Z /\ (nf <= 0)%Z /\ (ng <= 0)%Z /\ (nh <= 0)%Z} +
 {(na <= 0)%Z /\
  (nb <= 0)%Z /\
  (nc <= 0)%Z /\
  (nd <= 0)%Z /\ (0 <= ne)%Z /\ (0 <= nf)%Z /\ (0 <= ng)%Z /\ (0 <= nh)%Z} +
 {np1 = One /\
  (0 <= na + nc)%Z /\
  (0 <= nb + nd)%Z /\ (ne + ng <= 0)%Z /\ (nf + nh <= 0)%Z} +
 {np1 = One /\
  (na + nc <= 0)%Z /\
  (nb + nd <= 0)%Z /\ (0 <= ne + ng)%Z /\ (0 <= nf + nh)%Z} +
 {np1 = One /\ np2 = One} +
 {np1 <> One /\
  np2 = One /\
  (0 <= na + nb)%Z /\
  (0 <= nc + nd)%Z /\ (ne + nf <= 0)%Z /\ (ng + nh <= 0)%Z} +
 {np1 <> One /\
  np2 = One /\
  (na + nb <= 0)%Z /\
  (nc + nd <= 0)%Z /\ (0 <= ne + nf)%Z /\ (0 <= ng + nh)%Z}.
Proof.
 fix Qquadratic_sign_neg_2 9.
 intros.
 set (o1 := outside_square a b c d) in *.
 set (o2 := outside_square e f g h) in *.
 destruct p1 as [xs| xs| ].
 
 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; right; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; left; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_4 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_nR_7 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     left; left; left; left; left; case (inside_square_2_inf _ _ H_inside_2);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].

      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_nR_10 a b c d e f g h (nR xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_1 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign a (a + b) (a + c) (a + b + c + d) e 
          (e + f) (e + g) (e + f + g + h) xs ys
          (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 a (a + b)%Z (a + c)%Z 
             (a + b + c + d)%Z e (e + f)%Z (e + g)%Z 
             (e + f + g + h)%Z xs ys
             (Qquadratic_signok_1 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (nR xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (nR xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; right; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; left; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_4 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nR_dL_7 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (nR xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.

     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (nR xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (nR xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     left; left; left; left; left; case (inside_square_2_inf _ _ H_inside_2);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_nR_dL_10 a b c d e f g h (nR xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_2 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b) b (a + b + c + d) (b + d) 
          (e + f) f (e + f + g + h) (f + h) xs ys
          (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (nR xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b)%Z b (a + b + c + d)%Z 
             (b + d)%Z (e + f)%Z f (e + f + g + h)%Z 
             (f + h)%Z xs ys
             (Qquadratic_signok_2 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
 
  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (nR xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (nR xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (nR xs) H_Qhomographic_sg_denom_nonzero =
    ((-1)%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_neg_2 (a + b) (c + d) (e + f) (g + h) (nR xs)
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3];
   [ case l3; left;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; right; repeat split ]
   | case l3;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; left; right; repeat split ]
   | left; left; right; repeat split; assumption ].

 destruct p2 as [ys| ys| ].
  
  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (nR ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (nR ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; right; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; left; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_4 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_nR_7 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (nR ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.
         
     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (nR ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, nR ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     left; left; left; left; left; case (inside_square_2_inf _ _ H_inside_2);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].

      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_nR_10 a b c d e f g h (dL xs) xs 
          (nR ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_3 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + c) (a + b + c + d) c (c + d) 
          (e + g) (e + f + g + h) g (g + h) xs ys
          (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (nR ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + c)%Z (a + b + c + d)%Z c 
             (c + d)%Z (e + g)%Z (e + f + g + h)%Z g 
             (g + h)%Z xs ys
             (Qquadratic_signok_3 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.

  case (three_integers_dec_inf b c d).  
   
   intros (Hb, (Hc, Hd)).
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    generalize
     (Qquadratic_sign_nRdL_nRdL_1 a b c d e f g h (dL xs) 
        (dL ys) H_Qquadratic_sg_denom_nonzero).
    intros H1.
    assert
     (H_tuple_eq :
      ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
      ((Z.sgn a * Z.sgn e)%Z,
      (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
     [ apply
        trans_eq
         with
           (Qquadratic_sign a b c d e f g h (dL xs) 
              (dL ys) H_Qquadratic_sg_denom_nonzero);
        [ apply sym_eq | apply H1; discriminate || (repeat split) ];
        assumption
     | generalize
        (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
           _ _ H_tuple_eq);
        intros
         (hl,
          ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
          (hp1,
           hp2)));
        do 10
         match goal with
         | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
         end ].
    left; left; left; left; left; rewrite <- Zsgn_15 in hl.
    case (Zsgn_17 _ _ (sym_eq hl)); intros (Ha, He); [ left | right ];
     repeat split;
     repeat
      match goal with
      | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
      end; first [ apply Z.le_refl | apply Zlt_le_weak ]; 
     assumption.
    
    intros H_fgh'.
    case (Z_lt_dec 2 o2).
     
     intro Ho2.
     generalize
      (Qquadratic_sign_nRdL_nRdL_2 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn a, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; right; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o2 (-2)).     
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_3 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn a)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; left; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o2 in Ho2';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].
     
      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_4 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
   
   intros Hbcd'.
   
   case (three_integers_dec_inf f g h).   
    
    intros (Hf, (Hg, Hh)).
    case (Z_lt_dec 2 o1).
     
     intro Ho1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_5 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (Z.sgn e, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     left; left; left; left; left; left; repeat split;
      repeat
       match goal with
       | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
       end; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
     
     case (Z_lt_dec o1 (-2)).
      
      intros Ho1' Ho1.
      generalize
       (Qquadratic_sign_nRdL_nRdL_6 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((- Z.sgn e)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
      left; left; left; left; left; right; repeat split;
       repeat
        match goal with
        | id1:(?X1 = 0%Z) |- ?X2 => rewrite id1; clear id1
        end; first
       [ apply Z.le_refl
       | match goal with
         |  |- (0 <= ?X1)%Z =>
             apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
         |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
         end; apply sym_eq; assumption
       | unfold o1 in Ho1';
          match goal with
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X1)%Z =>
              apply outside_square_3 with X2 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X2)%Z =>
              apply outside_square_4 with X1 X3 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X3)%Z =>
              apply outside_square_5 with X1 X2 X4
          | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
          (0 <= ?X4)%Z =>
              apply outside_square_6 with X1 X2 X3
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X1 <= 0)%Z =>
              apply outside_square_7 with X2 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X2 <= 0)%Z =>
              apply outside_square_8 with X1 X3 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X3 <= 0)%Z =>
              apply outside_square_9 with X1 X2 X4
          | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
          (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
          end; assumption ].

      intros Ho2' Ho2.
      generalize
       (Qquadratic_sign_dL_dL_7 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
    
    intro Hfgh'.
    case (inside_square_1_dec_inf o1 o2).    
     
     intro H_inside_1.
     generalize
      (Qquadratic_sign_nRdL_nRdL_8 a b c d e f g h 
         (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
     intros H1.
     assert
      (H_tuple_eq :
       ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
       (1%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
      [ apply
         trans_eq
          with
            (Qquadratic_sign a b c d e f g h (dL xs) 
               (dL ys) H_Qquadratic_sg_denom_nonzero);
         [ apply sym_eq | apply H1; discriminate || (repeat split) ];
         assumption
      | generalize
         (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
            _ _ H_tuple_eq);
         intros
          (hl,
           ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
           (hp1,
            hp2)));
         do 10
          match goal with
          | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
          end ].
     discriminate hl.

     intro H_inside_1'.
     case (inside_square_2_dec_inf o1 o2).    
      
      intro H_inside_2.
      generalize
       (Qquadratic_sign_nRdL_nRdL_9 a b c d e f g h 
          (dL xs) (dL ys) H_Qquadratic_sg_denom_nonzero).
      intros H1.
      assert
       (H_tuple_eq :
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
        ((-1)%Z, (a, (b, (c, d)), (e, (f, (g, h))), (dL xs, dL ys))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq | apply H1; discriminate || (repeat split) ];
          assumption
       | generalize
          (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
             _ _ _ H_tuple_eq);
          intros
           (hl,
            ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
            (hp1,
             hp2)));
          do 10
           match goal with
           | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
           end ].
     left; left; left; left; left; case (inside_square_2_inf _ _ H_inside_2);
      intros (Ho1, Ho2); [ left | right ]; repeat split; first
      [ apply Z.le_refl
      | match goal with
        |  |- (0 <= ?X1)%Z =>
            apply Zlt_le_weak; apply Zsgn_9; apply Z.opp_inj
        |  |- (?X1 <= 0)%Z => apply Zlt_le_weak; apply Zsgn_10
        end; apply sym_eq; assumption
      | unfold o1 in Ho1; unfold o2 in Ho2;
         match goal with
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X1)%Z =>
             apply outside_square_3 with X2 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X2)%Z =>
             apply outside_square_4 with X1 X3 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X3)%Z =>
             apply outside_square_5 with X1 X2 X4
         | id1:(2 < outside_square ?X1 ?X2 ?X3 ?X4)%Z |- 
         (0 <= ?X4)%Z =>
             apply outside_square_6 with X1 X2 X3
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X1 <= 0)%Z =>
             apply outside_square_7 with X2 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X2 <= 0)%Z =>
             apply outside_square_8 with X1 X3 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X3 <= 0)%Z =>
             apply outside_square_9 with X1 X2 X4
         | id1:(outside_square ?X1 ?X2 ?X3 ?X4 < -2)%Z |- 
         (?X4 <= 0)%Z => apply outside_square_10 with X1 X2 X3
         end; assumption ].
      
      intros H_inside_2'. 
      generalize
       (Qquadratic_sign_dL_dL_10 a b c d e f g h (dL xs) xs 
          (dL ys) ys H_Qquadratic_sg_denom_nonzero
          (Qquadratic_signok_4 _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero)
          (refl_equal _) (refl_equal _)).
      intros H1.
      assert
       (H_tuple_eq :
        Qquadratic_sign (a + b + c + d) (b + d) (c + d) d 
          (e + f + g + h) (f + h) (g + h) h xs ys
          (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero) =
        ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))));
       [ apply
          trans_eq
           with
             (Qquadratic_sign a b c d e f g h (dL xs) 
                (dL ys) H_Qquadratic_sg_denom_nonzero);
          [ apply sym_eq; apply H1; repeat split | idtac ]
       | apply
          (Qquadratic_sign_neg_2 (a + b + c + d)%Z 
             (b + d)%Z (c + d)%Z d (e + f + g + h)%Z 
             (f + h)%Z (g + h)%Z h xs ys
             (Qquadratic_signok_4 e f g h xs ys H_Qquadratic_sg_denom_nonzero)
             na nb nc nd ne nf ng nh np1 np2) ]; assumption.
 
  generalize (Qquadratic_signok_0' _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_nRdL_One a b c d e f g h (dL xs) One
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (na_, (0%Z, nb_)), (0%Z, (nc_, (0%Z, nd_))), (l3, One))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h (dL xs) One
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + b) (c + d) (e + f) (g + h) 
      (dL xs) H_Qhomographic_sg_denom_nonzero =
    ((-1)%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_neg_2 (a + b) (c + d) (e + f) (g + h) (dL xs)
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3];
   [ case l3; left;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; right; repeat split ]
   | case l3;
      [ right; repeat split; assumption || discriminate
      | right; repeat split; assumption || discriminate
      | left; left; right; repeat split ]
   | left; left; right; repeat split; assumption ].

  generalize (Qquadratic_signok_0 _ _ _ _ _ H_Qquadratic_sg_denom_nonzero).
  intros H_Qhomographic_sg_denom_nonzero.
  set
   (L3 :=
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero) in *.
  set (l1 := fst L3) in *.
  set (l2 := fst (snd L3)) in *.
  set (l3 := snd (snd L3)) in *.
  set (na_ := fst l2) in *.
  set (nb_ := fst (snd l2)) in *.
  set (nc_ := fst (snd (snd l2))) in *.
  set (nd_ := snd (snd (snd l2))) in *.
  generalize
   (Qquadratic_sign_One_y a b c d e f g h One p2
      H_Qquadratic_sg_denom_nonzero l1 na_ nb_ nc_ nd_ l3
      H_Qhomographic_sg_denom_nonzero); intros H1.
  assert
   (H_tuple_eq :
    ((-1)%Z, (na, (nb, (nc, nd)), (ne, (nf, (ng, nh))), (np1, np2))) =
    (l1, (0%Z, (0%Z, (na_, nb_)), (0%Z, (0%Z, (nc_, nd_))), (One, l3))));
   [ apply
      trans_eq
       with
         (Qquadratic_sign a b c d e f g h One p2
            H_Qquadratic_sg_denom_nonzero);
      [ apply sym_eq; assumption
      | apply H1; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
         discriminate || reflexivity ]
   | generalize
      (Qquadratic_sign_tuple_equal _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
         _ H_tuple_eq);
      intros
       (hl,
        ((hna, (hnb, (hnc, (hnd, (hne, (hnf, (hng, hnh))))))),
        (hp1,
         hp2)));
      do 10
       match goal with
       | id1:(?X1 = ?X2) |- ?X3 => try rewrite id1; clear id1
       end; repeat rewrite ZERO_left; repeat rewrite Zplus_0_r ].
  assert
   (H_sg_unfolded :
    Qhomographic_sign (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero =
    ((-1)%Z, (na_, (nb_, (nc_, nd_)), l3))).
  rewrite hl; fold L3 in |- *; repeat (apply pair_2; try reflexivity);
   discriminate || reflexivity.
  generalize
   (sg_neg_2 (a + c) (b + d) (e + g) (f + h) p2
      H_Qhomographic_sg_denom_nonzero na_ nb_ nc_ nd_ l3 H_sg_unfolded).
  intros [[(H_a, (H_b, (H_c, H_d)))| (H_a, (H_b, (H_c, H_d)))]| H_l3]; left;
   left; [ left; left; right | left; right | right ]; 
   repeat split; assumption.
Qed.
