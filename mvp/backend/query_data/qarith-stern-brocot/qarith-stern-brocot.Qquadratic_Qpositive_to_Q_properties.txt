

Require Import FunInd.

Require Export Qquadratic.

Require Import homographic_correctness.
(* homographic_correctness:
Require Import FunInd.
Require Import Field_Theory_Q. 
Require Export Qhomographic_Qpositive_to_Q_properties.

Definition spec_fraction_encoding (a b : Z) : Q := Qmult a (Qinv b).

Definition spec_positive_fraction_encoding (a b : Z) 
  (Ha : (0 < a)%Z) (Hb : (0 < b)%Z) :=
  Qpositive_mult (Z_to_Qpositive a Ha) (Qpositive_inv (Z_to_Qpositive b Hb)). 

Definition spec_positive_fraction_encoding1 (a b : Z) :=
  Q_tail (Qmult a (Qinv b)).

Definition spec_positive_fraction_encoding2 (a b : Z) :=
  Qpositive_mult (Q_tail a) (Qpositive_inv (Q_tail b)). 

Lemma spec_coding :
 forall m n : nat,
 Qpositive_c (S m) (S n) (S m + S n) =
 spec_positive_fraction_encoding1 (m + 1) (n + 1).

Lemma spec_positive_fraction_encoding1_positive_fraction_encoding :
 forall (m n : Z) (Hm : (0 < m)%Z) (Hn : (0 < n)%Z),
 spec_positive_fraction_encoding m n Hm Hn =
 spec_positive_fraction_encoding1 m n.

Lemma spec_positive_fraction_encoding1_positive_fraction_encoding2 :
 forall (m n : Z) (Hm : (0 < m)%Z) (Hn : (0 < n)%Z),
 spec_positive_fraction_encoding m n Hm Hn =
 spec_positive_fraction_encoding2 m n.

Lemma coding :
 forall (m n : Z) (Hm : (0 < m)%Z) (Hn : (0 < n)%Z),
 positive_fraction_encoding m n Hm Hn =
 spec_positive_fraction_encoding m n Hm Hn. 

Functional Scheme Qmult_ind := Induction for Qmult Sort Prop.

Lemma coding_Q :
 forall (m n : Z) (Hdenom : n <> 0%Z),
 fraction_encoding m n Hdenom = spec_fraction_encoding m n. 

Definition spec_h (a b c d : Z) (q : Q) : Q :=
  Qmult (Qplus (Qmult a q) b) (Qinv (Qplus (Qmult c q) d)).

Definition spec_Qhomographic_Qpositive_to_Q (a b c d : Z) 
  (p : Qpositive) : Q :=
  Qmult (Qplus (Qmult a (Qpos p)) b) (Qinv (Qplus (Qmult c (Qpos p)) d)).

Definition spec_ni (a b c d : Z) (p : Qpositive) : Qpositive :=
  Q_tail
    (Qmult (Qplus (Qmult a (Qpos p)) b) (Qinv (Qplus (Qmult c (Qpos p)) d))).

Definition spec_ni2 (a b c d : Z) (p : Qpositive) : Qpositive :=
  Qpositive_mult (Q_tail (Qplus (Qmult a (Qpos p)) b))
    (Qpositive_inv (Q_tail (Qplus (Qmult c (Qpos p)) d))).

Lemma spec_Qhomographic_Qpositive_to_Q_nR :
 forall (a b c d : Z) (q : Qpositive),
 spec_Qhomographic_Qpositive_to_Q a b c d (nR q) =
 spec_Qhomographic_Qpositive_to_Q a (a + b) c (c + d) q.

Lemma spec_Qhomographic_Qpositive_to_Q_dL :
 forall (a b c d : Z) (q : Qpositive),
 spec_Qhomographic_Qpositive_to_Q a b c d (dL q) =
 spec_Qhomographic_Qpositive_to_Q (a + b) b (c + d) d q.

Lemma spec_Qhomographic_Qpositive_to_Q_nR_unfolded :
 forall (a b c d : Z) (q : Qpositive),
 Qmult (Qplus (Qmult a (Qpos (nR q))) b)
   (Qinv (Qplus (Qmult c (Qpos (nR q))) d)) =
 Qmult (Qplus (Qmult a (Qpos q)) (a + b)%Z)
   (Qinv (Qplus (Qmult c (Qpos q)) (c + d)%Z)).
Proof spec_Qhomographic_Qpositive_to_Q_nR.

Lemma spec_Qhomographic_Qpositive_to_Q_dL_unfolded :
 forall (a b c d : Z) (q : Qpositive),
 Qmult (Qplus (Qmult a (Qpos (dL q))) b)
   (Qinv (Qplus (Qmult c (Qpos (dL q))) d)) =
 Qmult (Qplus (Qmult (a + b)%Z (Qpos q)) b)
   (Qinv (Qplus (Qmult (c + d)%Z (Qpos q)) d)).
Proof spec_Qhomographic_Qpositive_to_Q_dL.

Lemma spec_ni2_nR :
 forall (a b c d : Z) (q : Qpositive),
 spec_ni2 a b c d (nR q) = spec_ni2 a (a + b) c (c + d) q.

Lemma spec_ni2_dL :
 forall (a b c d : Z) (q : Qpositive),
 Qplus (Qmult (a + b)%Z (Qpos q)) b <> Zero ->
 Qplus (Qmult (c + d)%Z (Qpos q)) d <> Zero ->
 spec_ni2 a b c d (dL q) = spec_ni2 (a + b) b (c + d) d q.

Lemma spec_ni2_nR_emission :
 forall (a b c d : Z) (q : Qpositive),
 Qlt Zero (Qplus (Qmult a (Qpos q)) b) ->
 Qlt Zero (Qplus (Qmult c (Qpos q)) d) ->
 Qlt Zero (Qplus (Qmult (a - c)%Z (Qpos q)) (b - d)%Z) ->
 nR (spec_ni2 (a - c) (b - d) c d q) = spec_ni2 a b c d q.

Lemma spec_ni2_dL_emission :
 forall (a b c d : Z) (q : Qpositive),
 Qlt Zero (Qplus (Qmult a (Qpos q)) b) ->
 Qlt Zero (Qplus (Qmult c (Qpos q)) d) ->
 Qlt Zero (Qplus (Qmult (c - a)%Z (Qpos q)) (d - b)%Z) ->
 dL (spec_ni2 a b (c - a) (d - b) q) = spec_ni2 a b c d q.

Lemma homographic_sign :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 h_sign a b c d p H_Qhomographic_sg_denom_nonzero =
 Qsgn (spec_Qhomographic_Qpositive_to_Q a b c d p).

Lemma homographicAcc_positive :
 forall (a b c d : Z) (p : Qpositive),
 homographicAcc a b c d p ->
 Qlt Zero (Qplus (Qmult (Z_to_Q a) (Qpos p)) (Z_to_Q b)) /\
 Qlt Zero (Qplus (Qmult (Z_to_Q c) (Qpos p)) (Z_to_Q d)).

Lemma homographicAcc_positive_numerator :
 forall (a b c d : Z) (p : Qpositive),
 homographicAcc a b c d p ->
 Qlt Zero (Qplus (Qmult (Z_to_Q a) (Qpos p)) (Z_to_Q b)).

Lemma homographicAcc_positive_denominator :
 forall (a b c d : Z) (p : Qpositive),
 homographicAcc a b c d p ->
 Qlt Zero (Qplus (Qmult (Z_to_Q c) (Qpos p)) (Z_to_Q d)).

Lemma output_bit :
 forall (a b c d : Z) (p : Qpositive) (hyp_Acc : homographicAcc a b c d p),
 Qhomographic_Qpositive_to_Qpositive a b c d p hyp_Acc = spec_ni2 a b c d p.

Lemma spec_Qhomographic_Qpositive_to_Q_spec_ni2_pos :
 forall (a b c d : Z) (q : Qpositive),
 Qsgn (spec_Qhomographic_Qpositive_to_Q a b c d q) = 1%Z ->
 spec_Qhomographic_Qpositive_to_Q a b c d q = Qpos (spec_ni2 a b c d q).

Lemma spec_Qhomographic_Qpositive_to_Q_spec_ni2_neg :
 forall (a b c d : Z) (q : Qpositive),
 Qsgn (spec_Qhomographic_Qpositive_to_Q a b c d q) = (-1)%Z ->
 spec_Qhomographic_Qpositive_to_Q a b c d q = Qneg (spec_ni2 a b c d q).

Lemma spec_Qhomographic_Qpositive_to_Q_spec_ni2_neg_1 :
 forall (a b c d : Z) (q : Qpositive),
 Qsgn (spec_Qhomographic_Qpositive_to_Q a b c d q) = (-1)%Z ->
 spec_Qhomographic_Qpositive_to_Q a b c d q =
 Qneg (spec_ni2 (- a) (- b) c d q).

Lemma spec_Qhomographic_Qpositive_to_Q_spec_ni2_neg_2 :
 forall (a b c d : Z) (q : Qpositive),
 Qsgn (spec_Qhomographic_Qpositive_to_Q a b c d q) = (-1)%Z ->
 spec_Qhomographic_Qpositive_to_Q a b c d q =
 Qneg (spec_ni2 a b (- c) (- d) q).

Lemma spec_Qhomographic_Qpositive_to_Q_Zopp :
 forall (a b c d : Z) (q : Qpositive),
 spec_Qhomographic_Qpositive_to_Q (- a) (- b) (- c) (- d) q =
 spec_Qhomographic_Qpositive_to_Q a b c d q.
 
Lemma spec_Qhomographic_Qpositive_to_Q_Zopp_2 :
 forall (a b c d : Z) (q : Qpositive),
 spec_Qhomographic_Qpositive_to_Q (- a) (- b) c d q =
 Qopp (spec_Qhomographic_Qpositive_to_Q a b c d q).
 
Lemma spec_Qhomographic_Qpositive_to_Q_Zopp_3 :
 forall (a b c d : Z) (q : Qpositive),
 spec_Qhomographic_Qpositive_to_Q a b (- c) (- d) q =
 Qopp (spec_Qhomographic_Qpositive_to_Q a b c d q).

Lemma sg_pres_fraction :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 Qmult
   (Qplus
      (Qmult (new_a a b c d p H_Qhomographic_sg_denom_nonzero)
         (Qpos (new_p a b c d p H_Qhomographic_sg_denom_nonzero)))
      (new_b a b c d p H_Qhomographic_sg_denom_nonzero))
   (Qinv
      (Qplus
         (Qmult (new_c a b c d p H_Qhomographic_sg_denom_nonzero)
            (Qpos (new_p a b c d p H_Qhomographic_sg_denom_nonzero)))
         (new_d a b c d p H_Qhomographic_sg_denom_nonzero))) =
 Qmult (Qplus (Qmult a (Qpos p)) b) (Qinv (Qplus (Qmult c (Qpos p)) d)).

Lemma a_field_equality_1 :
 forall x y z t w : Q,
 Qmult x t = Qmult y z ->
 t <> Zero ->
 Qplus (Qmult z w) t <> Zero ->
 Qmult (Qplus (Qmult x w) y) (Qinv (Qplus (Qmult z w) t)) = Qmult y (Qinv t).

Lemma Qhomographic_sg_denom_nonzero_correct_1 :
 forall (c d : Z) (p : Qpositive),
 Qhomographic_sg_denom_nonzero c d p -> Qplus (Qmult c (Qpos p)) d <> Zero.

Lemma Qhomographic_sg_denom_nonzero_correct_2 :
 forall (c d : Z) (p : Qpositive),
 Qplus (Qmult c (Qpos p)) d <> Zero -> Qhomographic_sg_denom_nonzero c d p.

Lemma homography_positive_input :
 forall (a b c d : Z) (p : Qpositive)
   (H_Qhomographic_sg_denom_nonzero : Qhomographic_sg_denom_nonzero c d p),
 Qhomographic_Qpositive_to_Q a b c d p H_Qhomographic_sg_denom_nonzero =
 Qmult (Qplus (Qmult a (Qpos p)) b) (Qinv (Qplus (Qmult c (Qpos p)) d)).

Lemma homography :
 forall (a b c d : Z) (s : Q)
   (H_Qhomographic_denom_nonzero : Qhomographic_denom_nonzero c d s),
 Qhomographic a b c d s H_Qhomographic_denom_nonzero = spec_h a b c d s.
 
Lemma Qhomographic_denom_nonzero_correct_1 :
 forall (c d : Z) (q : Q),
 Qplus (Qmult c q) d <> Zero -> Qhomographic_denom_nonzero c d q.
 
Lemma Qhomographic_denom_nonzero_correct_2 :
 forall (c d : Z) (q : Q),
 Qhomographic_denom_nonzero c d q -> Qplus (Qmult c q) d <> Zero.
 
Theorem homography_algorithm_is_correct :
 forall (a b c d : Z) (q : Q) (H_denom : Qplus (Qmult c q) d <> Zero),
 Qhomographic a b c d q (Qhomographic_denom_nonzero_correct_1 c d q H_denom) =
 Qmult (Qplus (Qmult a q) b) (Qinv (Qplus (Qmult c q) d)). *)



Lemma fraction_encoding_reduces :

 forall (a b m n : Z) (Hb : b <> 0%Z) (Hn : n <> 0%Z),

 (a * n)%Z = (m * b)%Z -> fraction_encoding a b Hb = fraction_encoding m n Hn.

Proof.

 intros a b m n Hb Hn H.

 do 2 rewrite coding_Q.

 unfold spec_fraction_encoding in |- *.

 rewrite (Qdiv_num_denom a b n).

 rewrite <- Z_to_Qmult.

 rewrite H.

 rewrite Z_to_Qmult.

 rewrite (Qmult_sym b n).

 rewrite <- Qdiv_num_denom.

 reflexivity.

 replace Zero with (Z_to_Q 0); trivial; apply Z_to_Q_not_eq; assumption.

 replace Zero with (Z_to_Q 0); trivial; apply Z_to_Q_not_eq; assumption.

Qed.



Functional Scheme Qquadratic_Qpositive_to_Q_ind := 

  Induction for Qquadratic_Qpositive_to_Q Sort Prop.



Lemma Qquadratic_Qpositive_to_Q_0 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)

   (Hh : h <> 0%Z),

 same_ratio a b c d e f g h ->

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero = fraction_encoding d h Hh. 

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

                                     H_Qquadratic_sg_denom_nonzero); 

            intros; try solve [ Falsum ];

	      match goal with 

		[ id:same_ratio _ _ _ _ _ _ _ _ |- _]  => 

		  elim id; intros h1 (h2, (h3, (h4, (h5, h6))));

		    apply fraction_encoding_reduces; trivial

	      end.

Qed.



Lemma Qquadratic_Qpositive_to_Q_1 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)

   (Hg : g <> 0%Z),

 same_ratio a b c d e f g h ->

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero = fraction_encoding c g Hg. 

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

                                     H_Qquadratic_sg_denom_nonzero); 

            intros; try solve [ Falsum ];

	      match goal with 

		[ id:same_ratio _ _ _ _ _ _ _ _ |- _]  => 

		  elim id; intros h1 (h2, (h3, (h4, (h5, h6))));

		    apply fraction_encoding_reduces; trivial; 

		      symmetry  in |- *; assumption

	      end.

Qed.



Lemma Qquadratic_Qpositive_to_Q_2 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)

   (Hf : f <> 0%Z),

 same_ratio a b c d e f g h ->

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero = fraction_encoding b f Hf. 

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

     H_Qquadratic_sg_denom_nonzero); 

   intros; try solve [ Falsum ];

     match goal with 

       [ id:same_ratio _ _ _ _ _ _ _ _ |- _]  => 

       elim id; intros h1 (h2, (h3, (h4, (h5, h6))));

	 apply fraction_encoding_reduces; trivial; 

           symmetry  in |- *; assumption

     end.

Qed.



Lemma Qquadratic_Qpositive_to_Q_3 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2)

   (He : e <> 0%Z),

 same_ratio a b c d e f g h ->

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero = fraction_encoding a e He. 

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

  functional induction

    (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

      H_Qquadratic_sg_denom_nonzero); 

    intros; try solve [ Falsum ];

      match goal with 

	[ id:same_ratio _ _ _ _ _ _ _ _ |- _]  => 

	elim id; intros h1 (h2, (h3, (h4, (h5, h6))));

          apply fraction_encoding_reduces; trivial; 

            symmetry  in |- *; assumption

      end.

Qed.



Ltac QSign_mismatch_ :=

  apply False_ind;

   match goal with

   | id1:(?X1 = 1%Z),id2:(?X1 = 0%Z) |- _ =>

       rewrite id2 in id1; discriminate id1

   | id1:(?X1 = (-1)%Z),id2:(?X1 = 0%Z) |- _ =>

       rewrite id2 in id1; discriminate id1

   | id1:(?X1 = 1%Z),id2:(?X1 = (-1)%Z) |- _ =>

       rewrite id2 in id1; discriminate id1



   | id2:(?X1 = 0%Z),id1:(?X1 = 1%Z) |- _ =>

       rewrite id2 in id1; discriminate id1

   | id1:(?X1 = 0%Z),id2:(?X1 = (-1)%Z) |- _ =>

       rewrite id2 in id1; discriminate id1

   | id1:(?X1 = (-1)%Z),id2:(?X1 = 1%Z) |- _ =>

       rewrite id2 in id1; discriminate id1



   end.



Ltac Absurd_q_sign_ :=

  match goal with

  | id1:(q_sign ?X1 ?X2 ?X3 ?X4 ?X5 ?X6 ?X7 ?X8 ?X9 ?X10 ?X11 = ?X0),id2:

  (Z.sgn _ = 0%Z) |- _ =>

      match constr:(X0) with

      | 0%Z => QSign_mismatch_

      end ||

        (apply False_ind;

          assert

           (HH :

            Qquadratic_sign X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11 =

            (X0,

            (qnew_a X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            (qnew_b X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            (qnew_c X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            qnew_d X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)),

            (qnew_e X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            (qnew_f X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            (qnew_g X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            qnew_h X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11))),

            (qnew_p1 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11,

            qnew_p2 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11))));

          [ rewrite <- id1;

             unfold qnew_a, qnew_b, qnew_c, qnew_d, qnew_e, qnew_f, qnew_g,

              qnew_h, qnew_p1, qnew_p2 in |- *;

             replace (q_sign X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11) with

              (fst (Qquadratic_sign X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11));

             [ idtac | reflexivity ]; repeat rewrite <- pair_1; 

             reflexivity

          | idtac ];

          match constr:(X0) with

          | 1%Z =>

              generalize

               (Qquadratic_sign_pos_1 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11

                  (qnew_a X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_b X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_c X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_d X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_e X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_f X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_g X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_h X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_p1 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_p2 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11) HH)

          | (-1)%Z =>

              generalize

               (Qquadratic_sign_neg_1 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11

                  (qnew_a X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_b X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_c X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_d X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_e X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_f X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_g X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_h X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_p1 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11)

                  (qnew_p2 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11) HH)

          end; intros [(na_nb_nc_nd_pos, _)| (na_nb_nc_nd_neg, _)];

          generalize (Zsgn_2 _ id2); [ apply sym_not_eq | idtac ];

          apply Zorder.Zlt_not_eq; assumption)

  end.



Lemma Qquadratic_Qpositive_to_Q_4 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),

 ~ same_ratio a b c d e f g h ->

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = 0%Z ->

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero = Zero. 

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

             (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

                                      H_Qquadratic_sg_denom_nonzero); 

            intros; try solve [ Falsum ]; trivial;Clear_eq_;

	      match goal with 

		[ id1 : q_sign ?a ?b ?c ?d ?e ?f ?g ?h ?p1 ?p2 ?H_Qquadratic_sg_denom_nonzero = _, 

		  id2 : q_sign ?a ?b ?c ?d ?e ?f ?g ?h ?p1 ?p2 ?H_Qquadratic_sg_denom_nonzero = _ |- _ ] => 

		rewrite id1 in id2;discriminate id2

	      end.

Qed.



Lemma Qquadratic_Qpositive_to_Q_5 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),

 ~ same_ratio a b c d e f g h ->

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = 1%Z ->

 Z.sgn

   (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero) = 1%Z ->

 forall

   hyp_quadraticAcc : quadraticAcc

                        (qnew_a a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_b a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_c a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_d a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_e a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_f a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_g a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_h a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p1 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p2 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero),

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero =

 Qpos

   (Qquadratic_Qpositive_to_Qpositive

      (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      hyp_quadraticAcc).

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

     H_Qquadratic_sg_denom_nonzero); 

   intros; try solve [ Falsum ]; trivial; Clear_eq_;

     QSign_mismatch_ || apply f_equal with Qpositive;

       apply Qquadratic_Qpositive_to_Qpositive_equal.

Qed.



Lemma Qquadratic_Qpositive_to_Q_6 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),

 ~ same_ratio a b c d e f g h ->

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = 1%Z ->

 Z.sgn

   (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero) = 

 (-1)%Z ->

 forall

   hyp_quadraticAcc : quadraticAcc

                        (-

                         qnew_a a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_b a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_c a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_d a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_e a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_f a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_g a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_h a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p1 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p2 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero),

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero =

 Qpos

   (Qquadratic_Qpositive_to_Qpositive

      (- qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      hyp_quadraticAcc).

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

     H_Qquadratic_sg_denom_nonzero); 

            intros; try solve [ Falsum ]; trivial; Clear_eq_;

              QSign_mismatch_ || apply f_equal with Qpositive;

		apply Qquadratic_Qpositive_to_Qpositive_equal.

Qed.



Lemma Qquadratic_Qpositive_to_Q_7 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),

 ~ same_ratio a b c d e f g h ->

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = (-1)%Z ->

 Z.sgn

   (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero) = 1%Z ->

 forall

   hyp_quadraticAcc : quadraticAcc

                        (qnew_a a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_b a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_c a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_d a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_e a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_f a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_g a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_h a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p1 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p2 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero),

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero =

 Qneg

   (Qquadratic_Qpositive_to_Qpositive

      (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      hyp_quadraticAcc).

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

     H_Qquadratic_sg_denom_nonzero); 

   intros; try solve [ Falsum ]; trivial; Clear_eq_;

     QSign_mismatch_ || apply f_equal with Qpositive;

            apply Qquadratic_Qpositive_to_Qpositive_equal.

Qed.



Lemma Qquadratic_Qpositive_to_Q_8 :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero : Qquadratic_sg_denom_nonzero e f g h p1 p2),

 ~ same_ratio a b c d e f g h ->

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero = (-1)%Z ->

 Z.sgn

   (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero +

    qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero) = 

 (-1)%Z ->

 forall

   hyp_quadraticAcc : quadraticAcc

                        (-

                         qnew_a a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_b a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_c a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (-

                         qnew_d a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_e a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_f a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_g a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_h a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p1 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero)

                        (qnew_p2 a b c d e f g h p1 p2

                           H_Qquadratic_sg_denom_nonzero),

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero =

 Qneg

   (Qquadratic_Qpositive_to_Qpositive

      (- qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (- qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      (qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero)

      hyp_quadraticAcc).

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero.

 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

     H_Qquadratic_sg_denom_nonzero); 

   intros; try solve [ Falsum ]; trivial; Clear_eq_;

     QSign_mismatch_ || apply f_equal with Qpositive;

       apply Qquadratic_Qpositive_to_Qpositive_equal.

Qed.



Lemma q_sign_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 q_sign a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2;

            change

              (fst

                 (Qquadratic_sign a b c d e f g h p1 p2

                    H_Qquadratic_sg_denom_nonzero1) =

               fst

                 (Qquadratic_sign a b c d e f g h p1 p2

                    H_Qquadratic_sg_denom_nonzero2)) 

             in |- *;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_a_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

  intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_a in |- *;

            apply f_equal with (Z * (Z * (Z * Z)))%type;

            apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_b_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_b in |- *;

            apply f_equal with (Z * (Z * Z))%type;

            apply f_equal with (Z * (Z * (Z * Z)))%type;

            apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_c_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

   H_Qquadratic_sg_denom_nonzero2; unfold qnew_c in |- *;

     apply f_equal with (Z * Z)%type;

       apply f_equal with (Z * (Z * Z))%type;

         apply f_equal with (Z * (Z * (Z * Z)))%type;

           apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

             apply

	       f_equal

               with

               (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

               apply

		 f_equal

		 with

                 (Z *

                   (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                     (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_d_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

  intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_d in |- *;

            apply f_equal with (Z * Z)%type;

            apply f_equal with (Z * (Z * Z))%type;

            apply f_equal with (Z * (Z * (Z * Z)))%type;

            apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_e_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_e a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

  intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2; unfold qnew_e in |- *;

      apply f_equal with (Z * (Z * (Z * Z)))%type;

        apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

          apply

            f_equal

            with

            (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

              (Qpositive * Qpositive))%type;

            apply

              f_equal

              with

              (Z *

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_f_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_f a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

  intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2; unfold qnew_f in |- *;

      apply f_equal with (Z * (Z * Z))%type;

        apply f_equal with (Z * (Z * (Z * Z)))%type;

          apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

              f_equal

              with

              (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                (Qpositive * Qpositive))%type;

              apply

		f_equal

		with

                (Z *

                  (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                    (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_g_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_g a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_g in |- *;

            apply f_equal with (Z * Z)%type;

            apply f_equal with (Z * (Z * Z))%type;

            apply f_equal with (Z * (Z * (Z * Z)))%type;

            apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_h_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_h a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_h in |- *;

            apply f_equal with (Z * Z)%type;

            apply f_equal with (Z * (Z * Z))%type;

            apply f_equal with (Z * (Z * (Z * Z)))%type;

            apply f_equal with (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))))%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_p1_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_p1 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_p1 in |- *;

            apply f_equal with (Qpositive * Qpositive)%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma qnew_p2_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1 =

 qnew_p2 a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1

            H_Qquadratic_sg_denom_nonzero2; unfold qnew_p2 in |- *;

            apply f_equal with (Qpositive * Qpositive)%type;

            apply

             f_equal

              with

                (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                 (Qpositive * Qpositive))%type;

            apply

             f_equal

              with

                (Z *

                 (Z * (Z * (Z * Z)) * (Z * (Z * (Z * Z))) *

                  (Qpositive * Qpositive)))%type; apply Qquadratic_sign_equal.

Qed.



Lemma Qquadratic_Qpositive_to_Q_equal :

 forall (a b c d e f g h : Z) (p1 p2 : Qpositive)

   (H_Qquadratic_sg_denom_nonzero1

    H_Qquadratic_sg_denom_nonzero2 : Qquadratic_sg_denom_nonzero e f g h p1

                                       p2),

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero1 =

 Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

   H_Qquadratic_sg_denom_nonzero2.

Proof.

 intros a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero1.



 functional induction

   (Qquadratic_Qpositive_to_Q a b c d e f g h p1 p2

                            H_Qquadratic_sg_denom_nonzero1); 

  intros; Clear_eq_.

 

 rewrite

  (Qquadratic_Qpositive_to_Q_3 _ _ _ _ _ _ _ _ _ _

     H_Qquadratic_sg_denom_nonzero2 He _x); reflexivity.

 

 rewrite

  (Qquadratic_Qpositive_to_Q_2 _ _ _ _ _ _ _ _ _ _

     H_Qquadratic_sg_denom_nonzero2 Hf _x); reflexivity.

 

 rewrite

  (Qquadratic_Qpositive_to_Q_1 _ _ _ _ _ _ _ _ _ _

     H_Qquadratic_sg_denom_nonzero2 Hg _x); reflexivity.

 

 rewrite

  (Qquadratic_Qpositive_to_Q_0 _ _ _ _ _ _ _ _ _ _

     H_Qquadratic_sg_denom_nonzero2 Hh _x); reflexivity.

 

 rewrite

  (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero1

     H_Qquadratic_sg_denom_nonzero2) in _x;

  rewrite

   (Qquadratic_Qpositive_to_Q_4 _ _ _ _ _ _ _ _ _ _

      H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh _x)

   ; reflexivity.

 

 Absurd_q_sign_.

 

 assert

  (H :

   Z.sgn

     (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2) = 1%Z).

   rewrite

    (qnew_a_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

       H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_b_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_c_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_d_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1); assumption.

   rewrite

    (Qquadratic_Qpositive_to_Q_5 _ _ _ _ _ _ _ _ _ _

       H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

       (trans_eq

          (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

             H_Qquadratic_sg_denom_nonzero1) l1_eq_one) H

       (Qquadratic_Qpositive_to_Q_quadraticAcc_pos_1 _ _ _ _ _ _ _ _ _ _

          H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

          (trans_eq

             (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

                H_Qquadratic_sg_denom_nonzero1) l1_eq_one) H))

    ; apply f_equal with Qpositive;

    apply Qquadratic_Qpositive_to_Qpositive_equal_strong;

    [ apply qnew_a_equal

    | apply qnew_b_equal

    | apply qnew_c_equal

    | apply qnew_d_equal

    | apply qnew_e_equal

    | apply qnew_f_equal

    | apply qnew_g_equal

    | apply qnew_h_equal

    | apply qnew_p1_equal

    | apply qnew_p2_equal ].

 

 assert

  (H :

   Z.sgn

     (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2) = 

   (-1)%Z).

   rewrite

    (qnew_a_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

       H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_b_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_c_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_d_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1); assumption.

   rewrite

    (Qquadratic_Qpositive_to_Q_6 _ _ _ _ _ _ _ _ _ _

       H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

       (trans_eq

          (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

             H_Qquadratic_sg_denom_nonzero1) l1_eq_one) H

       (Qquadratic_Qpositive_to_Q_quadraticAcc_pos_2 _ _ _ _ _ _ _ _ _ _

          H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

          (trans_eq

             (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

                H_Qquadratic_sg_denom_nonzero1) l1_eq_one) H))

    .

   apply f_equal with Qpositive;

    apply Qquadratic_Qpositive_to_Qpositive_equal_strong;

    try apply f_equal with Z;

    [ apply qnew_a_equal

    | apply qnew_b_equal

    | apply qnew_c_equal

    | apply qnew_d_equal

    | apply qnew_e_equal

    | apply qnew_f_equal

    | apply qnew_g_equal

    | apply qnew_h_equal

    | apply qnew_p1_equal

    | apply qnew_p2_equal ].

 

 Absurd_q_sign_.

 

 assert

  (H :

   Z.sgn

     (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2) = 1%Z).

   rewrite

    (qnew_a_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

       H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_b_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_c_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_d_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1); assumption.

   rewrite

    (Qquadratic_Qpositive_to_Q_7 _ _ _ _ _ _ _ _ _ _

       H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

       (trans_eq

          (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

             H_Qquadratic_sg_denom_nonzero1) l1_eq_min_one) H

       (Qquadratic_Qpositive_to_Q_quadraticAcc_neg_1 _ _ _ _ _ _ _ _ _ _

          H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

          (trans_eq

             (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

                H_Qquadratic_sg_denom_nonzero1) l1_eq_min_one) H))

    .

   apply f_equal with Qpositive;

    apply Qquadratic_Qpositive_to_Qpositive_equal_strong;

    try apply f_equal with Z;

    [ apply qnew_a_equal

    | apply qnew_b_equal

    | apply qnew_c_equal

    | apply qnew_d_equal

    | apply qnew_e_equal

    | apply qnew_f_equal

    | apply qnew_g_equal

    | apply qnew_h_equal

    | apply qnew_p1_equal

    | apply qnew_p2_equal ].

 

 assert

  (H :

   Z.sgn

     (qnew_a a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_b a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_c a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2 +

      qnew_d a b c d e f g h p1 p2 H_Qquadratic_sg_denom_nonzero2) = 

   (-1)%Z).

   rewrite

    (qnew_a_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

       H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_b_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_c_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1);

    rewrite

     (qnew_d_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

        H_Qquadratic_sg_denom_nonzero1); assumption.

   rewrite

    (Qquadratic_Qpositive_to_Q_8 _ _ _ _ _ _ _ _ _ _

       H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

       (trans_eq

          (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

             H_Qquadratic_sg_denom_nonzero1) l1_eq_min_one) H

       (Qquadratic_Qpositive_to_Q_quadraticAcc_neg_2 _ _ _ _ _ _ _ _ _ _

          H_Qquadratic_sg_denom_nonzero2 not_same_ratio_abcdefgh

          (trans_eq

             (q_sign_equal a b c d _ _ _ _ _ _ H_Qquadratic_sg_denom_nonzero2

                H_Qquadratic_sg_denom_nonzero1) l1_eq_min_one) H))

    .

   apply f_equal with Qpositive;

    apply Qquadratic_Qpositive_to_Qpositive_equal_strong;

    try apply f_equal with Z;

    [ apply qnew_a_equal

    | apply qnew_b_equal

    | apply qnew_c_equal

    | apply qnew_d_equal

    | apply qnew_e_equal

    | apply qnew_f_equal

    | apply qnew_g_equal

    | apply qnew_h_equal

    | apply qnew_p1_equal

    | apply qnew_p2_equal ].

Qed.

