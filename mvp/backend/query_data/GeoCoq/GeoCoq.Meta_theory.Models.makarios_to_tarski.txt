Require Import GeoCoq.Axioms.tarski_axioms.
(* GeoCoq.Axioms.tarski_axioms:
Require Export GeoCoq.Utils.general_tactics.

Class Tarski_neutral_dimensionless :=
{
 Tpoint : Type;
 Bet : Tpoint -> Tpoint -> Tpoint -> Prop;
 Cong : Tpoint -> Tpoint -> Tpoint -> Tpoint -> Prop;
 cong_pseudo_reflexivity : forall A B, Cong A B B A;
 cong_inner_transitivity : forall A B C D E F,
   Cong A B C D -> Cong A B E F -> Cong C D E F;
 cong_identity : forall A B C, Cong A B C C -> A = B;
 segment_construction : forall A B C D,
   exists E, Bet A B E /\ Cong B E C D;
 five_segment : forall A A' B B' C C' D D',
   Cong A B A' B' ->
   Cong B C B' C' ->
   Cong A D A' D' ->
   Cong B D B' D' ->
   Bet A B C -> Bet A' B' C' -> A <> B -> Cong C D C' D';
 between_identity : forall A B, Bet A B A -> A = B;
 inner_pasch : forall A B C P Q,
   Bet A P C -> Bet B Q C ->
   exists X, Bet P X B /\ Bet Q X A;
 PA : Tpoint;
 PB : Tpoint;
 PC : Tpoint;
 lower_dim : ~ (Bet PA PB PC \/ Bet PB PC PA \/ Bet PC PA PB)
}.

Class Tarski_neutral_dimensionless_with_decidable_point_equality
 `(Tn : Tarski_neutral_dimensionless) :=
{
 point_equality_decidability : forall A B : Tpoint, A = B \/ ~ A = B
}.

Class Tarski_2D
 `(TnEQD : Tarski_neutral_dimensionless_with_decidable_point_equality) :=
{
 upper_dim : forall A B C P Q,
   P <> Q -> Cong A P A Q -> Cong B P B Q -> Cong C P C Q ->
   (Bet A B C \/ Bet B C A \/ Bet C A B)
}.

Class Tarski_3D
 `(TnEQD : Tarski_neutral_dimensionless_with_decidable_point_equality) :=
{
 S1 : Tpoint;
 S2 : Tpoint;
 S3 : Tpoint;
 S4 : Tpoint;
 lower_dim_3 : ~ exists X,
   (Bet S1 S2 X \/ Bet S2 X S1 \/ Bet X S1 S2) /\ (Bet S3 S4 X \/ Bet S4 X S3 \/ Bet X S3 S4) \/
   (Bet S1 S3 X \/ Bet S3 X S1 \/ Bet X S1 S3) /\ (Bet S2 S4 X \/ Bet S4 X S2 \/ Bet X S2 S4) \/
   (Bet S1 S4 X \/ Bet S4 X S1 \/ Bet X S1 S4) /\ (Bet S2 S3 X \/ Bet S3 X S2 \/ Bet X S2 S3);
 upper_dim_3 : forall A B C P Q R,
   P <> Q -> Q <> R -> P <> R ->
   Cong A P A Q -> Cong B P B Q -> Cong C P C Q ->
   Cong A P A R -> Cong B P B R -> Cong C P C R ->
   (Bet A B C \/ Bet B C A \/ Bet C A B)
}.

Class Tarski_euclidean
 `(TnEQD : Tarski_neutral_dimensionless_with_decidable_point_equality) :=
{
 euclid : forall A B C D T,
   Bet A D T -> Bet B D C -> A<>D ->
   exists X, exists Y,
   Bet A B X /\ Bet A C Y /\ Bet X T Y
}.

Class Tarski_ruler_and_compass
 `(TnEQD : Tarski_neutral_dimensionless_with_decidable_point_equality) :=
{
 circle_circle_continuity : forall A B C D B' D',
   Cong A B' A B -> Cong C D' C D ->
   Bet A D' B -> Bet C B' D ->
   exists Z, Cong A Z A B /\ Cong C Z C D
}.

Class Tarski_continuous
 `(TnEQD : Tarski_neutral_dimensionless_with_decidable_point_equality) :=
{
 continuity : forall (Alpha Beta : Tpoint -> Prop),
   (exists A, forall X Y, Alpha X -> Beta Y -> Bet A X Y) ->
   (exists B, forall X Y, Alpha X -> Beta Y -> Bet X B Y)
}. *)

Require Import GeoCoq.Axioms.makarios_variant_axioms.
(* GeoCoq.Axioms.makarios_variant_axioms:
Class Tarski_neutral_dimensionless_variant := {
 MTpoint : Type;
 BetM : MTpoint -> MTpoint -> MTpoint -> Prop;
 CongM : MTpoint -> MTpoint -> MTpoint -> MTpoint -> Prop;
 Mcong_identity : forall A B C, CongM A B C C -> A = B;
 Mcong_inner_transitivity : forall A B C D E F,
   CongM A B C D -> CongM A B E F -> CongM C D E F;
 Msegment_construction : forall A B C D,
   exists E, BetM A B E /\ CongM B E C D;
 Mfive_segment : forall A A' B B' C C' D D',
   CongM A B A' B' ->
   CongM B C B' C' ->
   CongM A D A' D' ->
   CongM B D B' D' ->
   BetM A B C -> BetM A' B' C' -> A <> B ->
   CongM D C C' D';
 Mbetween_identity : forall A B, BetM A B A -> A = B;
 Minner_pasch : forall A B C P Q,
   BetM A P C -> BetM B Q C ->
   exists X, BetM P X B /\ BetM Q X A;
 MPA : MTpoint;
 MPB : MTpoint;
 MPC : MTpoint;
 Mlower_dim : ~ (BetM MPA MPB MPC \/ BetM MPB MPC MPA \/ BetM MPC MPA MPB)
 }.

Class Tarski_neutral_dimensionless_variant_with_decidable_point_equality
 `(Tn : Tarski_neutral_dimensionless_variant) :=
{
 Mpoint_equality_decidability : forall A B : MTpoint, A = B \/ ~ A = B
}. *)



Section Makarios_variant_to_Tarski83.



Context `{MTn:Tarski_neutral_dimensionless_variant_with_decidable_point_equality}.



Ltac prolong A B x C D :=

 assert (sg:= Msegment_construction A B C D);

 ex_and sg x.



Lemma Mcong_reflexivity : forall A B,

 CongM A B A B.

Proof.

intros.

prolong B A x A B.

eapply Mcong_inner_transitivity with A x;auto.

Qed.



Lemma Mcong_symmetry : forall A B C D ,

 CongM A B C D -> CongM C D A B.

Proof.

intros.

eapply Mcong_inner_transitivity.

apply H.

apply Mcong_reflexivity.

Qed.



Lemma between_trivial : forall A B, BetM A B B.

Proof.

intros.

prolong A B x B B.

assert (x = B)

 by (apply Mcong_identity in H0;auto).

subst;assumption.

Qed.



Lemma Mcong_trivial_identity : forall A B, CongM A A B B.

Proof.

  intros.

  assert (sg:= Msegment_construction A A B B);

  ex_and sg x.

  assert( A = x) by (eapply Mcong_identity;eauto).

  subst.

  assumption.

Qed.



Lemma LmCoghGrab : forall A B C D E F,

  A <> B -> BetM B A C -> BetM D A E ->

  CongM B A D A -> CongM A C A E -> CongM B F D F ->

  CongM F C E F.

Proof.

  intros.

  assert(CongM A F A F) by (eapply Mcong_reflexivity;eauto).

  assert(forall A A' B B' C C' D D':MTpoint,

   CongM A B A' B' -> CongM B C B' C' ->

   CongM A D A' D' -> CongM B D B' D' ->

   BetM A B C -> BetM A' B' C' -> A <> B ->

   CongM D C C' D') by apply Mfive_segment.

  apply (H6 B D A A);auto.

Qed.



Lemma cong_pre_pseudo_reflexivity : forall A B C D,

  C <> D -> BetM D C B -> CongM A B B A.

Proof.

  intros.

  assert(CongM C B C B) by (eapply Mcong_reflexivity;eauto).

  assert(CongM D C D C) by (eapply Mcong_reflexivity;eauto).

  assert(CongM D A D A) by (eapply Mcong_reflexivity;eauto).

  eapply LmCoghGrab;eauto.

Qed.



Lemma cong_pseudo_reflexivity : forall A B, CongM A B B A.

Proof.

  intros.

  elim (Mpoint_equality_decidability A B).

    intros.

    subst.

    eapply Mcong_trivial_identity;eauto.



    intros.

    assert(BetM B A A) by (eapply between_trivial;eauto).

    eapply Mcong_symmetry;eauto.

    eapply cong_pre_pseudo_reflexivity;eauto.

Qed.



Lemma five_segment : forall A A' B B' C C' D D',

  CongM A B A' B' ->

  CongM B C B' C' ->

  CongM A D A' D' ->

  CongM B D B' D' ->

  BetM A B C -> BetM A' B' C' -> A <> B ->

  CongM C D C' D'.

Proof.

  intros.

  assert(CongM D C C' D').

  intros.

  eapply Mfive_segment with A A' B B';assumption.

  assert(CongM D C C D).

  eapply cong_pseudo_reflexivity;eauto.

  eapply Mcong_inner_transitivity with D C;eauto.

Qed.



Instance Tarski_follows_from_Makarios_Variant : Tarski_neutral_dimensionless.

Proof.

exact (Build_Tarski_neutral_dimensionless

 MTpoint BetM CongM

 cong_pseudo_reflexivity

 Mcong_inner_transitivity

 Mcong_identity

 Msegment_construction

 five_segment

 Mbetween_identity

 Minner_pasch

 MPA MPB MPC

 Mlower_dim).

Defined.



Instance Tarski_follows_from_Makarios_Variant_with_decidable_point_equality' :

  Tarski_neutral_dimensionless_with_decidable_point_equality Tarski_follows_from_Makarios_Variant.

Proof. split; apply Mpoint_equality_decidability. Defined.



End Makarios_variant_to_Tarski83.
