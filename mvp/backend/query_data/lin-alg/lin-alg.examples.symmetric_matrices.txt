
Set Implicit Arguments.
Unset Strict Implicit.
Require Export vecspace_Mmn.
(* vecspace_Mmn:
Set Automatic Coercions Import.
Set Implicit Arguments.
Unset Strict Implicit.
Require Export Matrices.

Section Vectorspace.
Variable F : field.
Variable m n : Nat.

Definition Mmn_set : SET.

Let add_law : law_of_composition Mmn_set.

Definition Mmn_sgp : SGROUP.

Definition Mmn_mon : MONOID.

Section group.
Let minmatrix : Mmn_mon -> Mmn_mon.

Let minmatrixmap : Map Mmn_mon Mmn_mon.

Definition Mmn_gp : GROUP.
End group.

Definition Mmn_abgp : ABELIAN_GROUP.

Section module.
Let scmult_sgp_fun : F -> Endo_SET Mmn_abgp.

Let scmult_sgp_map : Map (Build_monoid (ring_monoid F)) (Endo_SET Mmn_abgp).

Let scmult_sgp_hom :
  sgroup_hom (Build_monoid (ring_monoid F)) (Endo_SET Mmn_abgp).

Let scmult_mon_hom :
  monoid_hom (Build_monoid (ring_monoid F)) (Endo_SET Mmn_abgp).

Definition Mmn : VECSP F.
End module.
End Vectorspace.

Definition row_Map2 :
  forall (F : field) (m n : Nat), MAP2 (Mmn F m n) (fin m) (Fn F n).

Definition col_Map2 :
  forall (F : field) (m n : Nat), MAP2 (Mmn F m n) (fin n) (Fn F m). *)
Require Export subspaces.
(* subspaces:
Section MAIN.
Set Implicit Arguments.
Unset Strict Implicit.
Require Export vecspaces_verybasic.
Require Export arb_intersections.
From Algebra Require Export Sub_module.
From Algebra Require Export Singleton.
Require Export algebra_omissions.

Variable F : field.
Variable V : vectorspace F.
Section Subspace_def.

Definition subspace (F : field) (V : vectorspace F) := submodule V.

Variable W : subspace V.
Definition inj_subspace : Hom (W:VECSP F) V.

Lemma inj_subspace_injective : injective inj_subspace.

Lemma mult_inherited :
 forall (c : F) (x : W), inj_subspace (c mX x) =' c mX inj_subspace x in _.
End Subspace_def.

Section subspace_awkward_utils.

Definition is_subspace (W : part_set V) : Prop :=
  in_part (zero V) W /\
  (forall x y : V, in_part x W -> in_part y W -> in_part (x +' y) W) /\
  (forall (c : F) (x : V), in_part x W -> in_part (c mX x) W).

Lemma is_subspace_comp :
 forall S S' : part_set V, S =' S' in _ -> is_subspace S -> is_subspace S'.

Definition subspace_construction :
  forall Ws : part_set V,
  is_subspace Ws -> sigT (fun W : subspace V => W =' Ws in part_set V).

Definition alt_Build_subspace (W : part_set V) (H : is_subspace W) :
  subspace V := let (w, _) := subspace_construction H in w.

Lemma alt_Build_subspace_OK :
 forall (W : part_set V) (HW : is_subspace W),
 W =' alt_Build_subspace HW in _.

Lemma is_subspace_OK : forall W : subspace V, is_subspace W.

Lemma subspace_alt_characterization :
 forall Ws : part_set V,
 in_part (zero V) Ws /\
 (forall x y : V, in_part x Ws -> in_part y Ws -> in_part (x +' y) Ws) /\
 (forall (c : F) (x : V), in_part x Ws -> in_part (c mX x) Ws) <->
 (exists W : subspace V, W =' Ws in part_set V).

Definition Set_of_subspaces : part_set (part_set V).

Lemma Set_of_subspaces_closed_under_intersection :
 forall WS : part_set Set_of_subspaces,
 is_subspace (intersection (inject_subsets WS)).
End subspace_awkward_utils.

End MAIN.

Section Examples.
Variable F : field.
Variable V : vectorspace F.

Lemma singleton_zero_is_subspace : is_subspace (single (zero V)).

Definition triv_subspace : subspace V.

Definition full_subspace : subspace V.
End Examples. *)

Section defs.
Definition is_symmetric (F : field) (n : Nat) (M : matrix F n n) :=
  forall i j : fin n, M i j =' M j i in _.
Definition is_symmetric' (F : field) (n : Nat) (M : matrix F n n) :=
  M =' transpose M in _.

Definition is_symmetric_pred :
  forall (F : field) (n : Nat), Predicate (Mmn F n n).
intros; apply (Build_Predicate (Pred_fun:=is_symmetric (F:=F) (n:=n))).
red in |- *; simpl in |- *; red in |- *.
intros; red in H.
apply Trans with (x i j); auto with algebra.
apply Trans with (x j i); auto with algebra.
apply Sym; auto with algebra.
Defined.

Definition is_symmetric'_pred :
  forall (F : field) (n : Nat), Predicate (Mmn F n n).
intros; apply (Build_Predicate (Pred_fun:=is_symmetric' (F:=F) (n:=n))).
red in |- *; simpl in |- *; red in |- *.
intros; red in H.
destruct x; destruct y.
simpl in |- *; simpl in H, H0.
intros.
apply Trans with (Ap2 a b); auto with algebra.
apply Trans with (Ap2 b a); auto with algebra.
apply Trans with (Ap0 b a); auto with algebra.
apply Sym; auto with algebra.
Defined.

Lemma symm_defs_eqv :
 forall (F : field) (n : Nat),
 is_symmetric_pred F n =' is_symmetric'_pred F n in part_set (Mmn F n n).
intros.
simpl in |- *.
red in |- *.
split; simpl in |- *; intro; red in H; red in |- *.
unfold transpose in |- *; destruct x; simpl in |- *.
simpl in H; intros; (apply Trans with (Ap2 b a); auto with algebra).
unfold transpose in H; destruct x; simpl in |- *.
simpl in H; intros.
auto with algebra.
Qed.
End defs.

Lemma symm_matr_subspace :
 forall (n : Nat) (F : field), is_subspace (is_symmetric_pred F n).
red in |- *; intros.
split; try split; simpl in |- *.
red in |- *.
simpl in |- *.
auto with algebra.
intros.
red in H0, H.
destruct x; destruct y.
simpl in H0, H.
red in |- *; simpl in |- *.
intros.
apply SGROUP_comp; auto with algebra.
intros; destruct x; red in H; red in |- *; simpl in H; simpl in |- *.
intros.
apply RING_comp; auto with algebra.
Qed.

Definition symm_subspace n F := alt_Build_subspace (symm_matr_subspace n F).