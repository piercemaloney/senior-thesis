
Require Import bdds.

Definition Z_of_N (node : ad) :=
  match node with
  | N0 => 0%Z
  | Npos p => Zpos p
  end.

Definition test (be : bool_expr) :=
  match BDDof_bool_expr initBDDconfig initBDDneg_memo initBDDor_memo be with
  | ((bs, (share, counter)), (ad, _)) => (Z_of_N counter, Z_of_N ad)
  end.

Definition v (n : nat) := Var (N_of_nat n).

Fixpoint A_bound (n bound : nat) {struct bound} : bool_expr :=
  match bound with
  | O => v n
  | S bound' => Iff (v (n - bound)) (A_bound n bound')
  end.

Definition A (n : nat) := A_bound n n.

Fixpoint U_bound (n bound : nat) {struct bound} : bool_expr :=
  match bound with
  | O => A n
  | S bound' => Iff (v (n - bound')) (U_bound n bound')
  end.

Definition U (n : nat) := U_bound n (S n).